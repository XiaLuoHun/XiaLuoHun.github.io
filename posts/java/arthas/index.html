<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Arthas   夏洛魂的个人博客</title><meta name="author" content="夏洛魂">
<meta name="description" content="
Arthas是一款线上监控诊断产品,通过全局视角实时查看应用load、内存、gc、线程的状态信息,并能在不修改应用代码的情况下,对业务问题进行诊断,包括查看方法调用的出入参、异常,监测方法执行耗时,类加载信息等,大大提升线上问题排查效率.
"><meta name="keywords" content='Java'>
  <meta itemprop="name" content="Arthas">
  <meta itemprop="description" content="Arthas是一款线上监控诊断产品,通过全局视角实时查看应用load、内存、gc、线程的状态信息,并能在不修改应用代码的情况下,对业务问题进行诊断,包括查看方法调用的出入参、异常,监测方法执行耗时,类加载信息等,大大提升线上问题排查效率.">
  <meta itemprop="datePublished" content="2024-06-11T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-06-11T00:00:00+00:00">
  <meta itemprop="wordCount" content="6189">
  <meta itemprop="image" content="https://XiaLuoHun.top/posts/java/arthas/images/%E8%BF%90%E8%A1%8Carthas-boot.png">
  <meta itemprop="keywords" content="Java"><meta property="og:url" content="https://XiaLuoHun.top/posts/java/arthas/">
  <meta property="og:site_name" content="夏洛魂的个人博客">
  <meta property="og:title" content="Arthas">
  <meta property="og:description" content="Arthas是一款线上监控诊断产品,通过全局视角实时查看应用load、内存、gc、线程的状态信息,并能在不修改应用代码的情况下,对业务问题进行诊断,包括查看方法调用的出入参、异常,监测方法执行耗时,类加载信息等,大大提升线上问题排查效率.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-06-11T00:00:00+00:00">
    <meta property="article:tag" content="Java">
    <meta property="og:image" content="https://XiaLuoHun.top/posts/java/arthas/images/%E8%BF%90%E8%A1%8Carthas-boot.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://XiaLuoHun.top/posts/java/arthas/images/%E8%BF%90%E8%A1%8Carthas-boot.png">
  <meta name="twitter:title" content="Arthas">
  <meta name="twitter:description" content="Arthas是一款线上监控诊断产品,通过全局视角实时查看应用load、内存、gc、线程的状态信息,并能在不修改应用代码的情况下,对业务问题进行诊断,包括查看方法调用的出入参、异常,监测方法执行耗时,类加载信息等,大大提升线上问题排查效率.">
<meta name="application-name" content="夏洛魂">
<meta name="apple-mobile-web-app-title" content="夏洛魂"><meta name="theme-color" data-light="#ffffff" data-dark="#ffffff" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="canonical" type="text/html" href="https://XiaLuoHun.top/posts/java/arthas/" title="Arthas   夏洛魂的个人博客" /><link rel="prev" type="text/html" href="https://XiaLuoHun.top/posts/web%E5%AE%89%E5%85%A8/dvwa%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="DVWA通关记录" /><link rel="next" type="text/html" href="https://XiaLuoHun.top/posts/x64dbg/x64dbg-%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/" title="x64Dbg-命令详解" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Arthas",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/XiaLuoHun.top\/posts\/java\/arthas\/"
    },"image": [{
              "@type": "ImageObject",
              "url": "https:\/\/XiaLuoHun.top\/posts\/java\/arthas\/images\/%E8%BF%90%E8%A1%8Carthas-boot.png",
              "width":  1561 ,
              "height":  884 
            }],"genre": "posts","keywords": "Java","wordcount":  6189 ,
    "url": "https:\/\/XiaLuoHun.top\/posts\/java\/arthas\/","datePublished": "2024-06-11T00:00:00+00:00","dateModified": "2024-06-11T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "夏洛魂"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="夏洛魂的个人博客"><span class="header-title-text">夏洛魂</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/">文章</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/">标签</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/">分类</a></li><li class="menu-item">
              <a class="menu-link" href="/excalidraw/">在线绘图</a></li><li class="menu-item">
              <a class="menu-link" href="/about/">关于作者</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="输入关键词搜索" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="夏洛魂的个人博客"><span class="header-title-text">夏洛魂</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="输入关键词搜索" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/">文章</a></li><li class="menu-item"><a class="menu-link" href="/tags/">标签</a></li><li class="menu-item"><a class="menu-link" href="/categories/">分类</a></li><li class="menu-item"><a class="menu-link" href="/excalidraw/">在线绘图</a></li><li class="menu-item"><a class="menu-link" href="/about/">关于作者</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>Arthas</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="/images/Luo.png" alt="夏洛魂" data-title="夏洛魂" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;夏洛魂</span></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/java/" class="post-category" title="分类 - Java"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Java</a></span></div><div class="post-meta-line"><span title="发布于 2024-06-11 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-06-11">2024-06-11</time></span>&nbsp;<span title="6189 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 6200 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 13 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#测试代码">测试代码</a></li>
    <li><a href="#附加进程">附加进程</a></li>
    <li><a href="#基础命令">基础命令</a></li>
    <li><a href="#jvm命令">JVM命令</a></li>
    <li><a href="#classclassloader命令">Class/Classloader命令</a>
      <ul>
        <li><a href="#sc">sc</a></li>
        <li><a href="#sm">sm</a></li>
        <li><a href="#jad">jad</a></li>
        <li><a href="#mc">mc</a></li>
        <li><a href="#redefine">redefine</a></li>
        <li><a href="#retransform">retransform</a></li>
        <li><a href="#dump">dump</a></li>
        <li><a href="#classloader">classloader</a></li>
      </ul>
    </li>
    <li><a href="#进阶命令">进阶命令</a>
      <ul>
        <li><a href="#monitor">monitor</a></li>
        <li><a href="#watch">watch</a></li>
        <li><a href="#trace">trace</a></li>
        <li><a href="#stack">stack</a></li>
        <li><a href="#tt">tt</a></li>
        <li><a href="#options">options</a></li>
      </ul>
    </li>
    <li><a href="#参考链接">参考链接</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="「依旧是、江涛如许，雨帆烟笛！」"><p><img loading="lazy" src="/posts/java/arthas/images/arthas.png" alt="arthas" srcset="/posts/java/arthas/images/arthas.png?size=small, /posts/java/arthas/images/arthas.png?size=medium 1.5x, /posts/java/arthas/images/arthas.png?size=large 2x" data-title="arthas" style="--width: 320px;--aspect-ratio: 320 / 105;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>Arthas是一款线上监控诊断产品,通过全局视角实时查看应用load、内存、gc、线程的状态信息,并能在不修改应用代码的情况下,对业务问题进行诊断,包括查看方法调用的出入参、异常,监测方法执行耗时,类加载信息等,大大提升线上问题排查效率.</p>
<p><a href="https://github.com/alibaba/arthas"target="_blank" rel="external nofollow noopener noreferrer">https://github.com/alibaba/arthas</a></p>
<h2 id="测试代码" class="heading-element"><span>测试代码</span>
  <a href="#%e6%b5%8b%e8%af%95%e4%bb%a3%e7%a0%81" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">demo</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Random</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.TimeUnit</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MathGame</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Random</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">illegalArgumentCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">MathGame</span><span class="w"> </span><span class="n">game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MathGame</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">game</span><span class="p">.</span><span class="na">run</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">()</span><span class="o">/</span><span class="n">10000</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">primeFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">primeFactors</span><span class="p">(</span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">print</span><span class="p">(</span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">primeFactors</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&#34;illegalArgumentCount:%3d, &#34;</span><span class="p">,</span><span class="w"> </span><span class="n">illegalArgumentCount</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">primeFactors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">StringBuffer</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuffer</span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;=&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">primeFactors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">factor</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="sc">&#39;*&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sb</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">sb</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;*&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sb</span><span class="p">.</span><span class="na">deleteCharAt</span><span class="p">(</span><span class="n">sb</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">primeFactors</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">illegalArgumentCount</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&#34;number is: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;, need &gt;= 2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">result</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">i</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="附加进程" class="heading-element"><span>附加进程</span>
  <a href="#%e9%99%84%e5%8a%a0%e8%bf%9b%e7%a8%8b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>启动Demo</li>
</ol>
<p><img loading="lazy" src="./images/%E5%90%AF%E5%8A%A8Demo.png" alt="启动Demo" srcset="./images/%E5%90%AF%E5%8A%A8Demo.png?size=small, ./images/%E5%90%AF%E5%8A%A8Demo.png?size=medium 1.5x, ./images/%E5%90%AF%E5%8A%A8Demo.png?size=large 2x" data-title="启动Demo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="2">
<li>执行arthas-boot.jar进行附加</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">java -jar arthas-boot.jar</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/%E8%BF%90%E8%A1%8Carthas-boot.png" alt="运行arthas-boot" srcset="./images/%E8%BF%90%E8%A1%8Carthas-boot.png?size=small, ./images/%E8%BF%90%E8%A1%8Carthas-boot.png?size=medium 1.5x, ./images/%E8%BF%90%E8%A1%8Carthas-boot.png?size=large 2x" data-title="运行arthas-boot" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>如果提示端口被占用,可以使用下述命令进行端口自定义.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">java -jar arthas-boot.jar --telnet-port 9998 --http-port -1</span></span></code></pre></td></tr></table>
</div>
</div><p>如果附加成功,Arthas会在下述目录进行日志记录.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">%HOMEPATH%/logs/arthas</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>通过浏览器连接Arthas</li>
</ol>
<p>Arthas目前支持Web Console,用户在attach成功之后,可以直接访问:http://127.0.0.1:3658/</p>
<p><img loading="lazy" src="./images/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A7%E5%88%B6%E5%8F%B0.png" alt="浏览器控制台" srcset="./images/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A7%E5%88%B6%E5%8F%B0.png?size=small, ./images/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A7%E5%88%B6%E5%8F%B0.png?size=medium 1.5x, ./images/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A7%E5%88%B6%E5%8F%B0.png?size=large 2x" data-title="浏览器控制台" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>默认情况下,Arthas只listen 127.0.0.1,所以如果想从远程连接,则可以使用&ndash;target-ip参数指定listen的IP</p>
<h2 id="基础命令" class="heading-element"><span>基础命令</span>
  <a href="#%e5%9f%ba%e7%a1%80%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><table>
  <thead>
      <tr>
          <th style="text-align: left">基础命令</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">base64</td>
          <td style="text-align: left">base64编码转换.同Linux base64</td>
      </tr>
      <tr>
          <td style="text-align: left">cat</td>
          <td style="text-align: left">打印文件内容.同Linux cat</td>
      </tr>
      <tr>
          <td style="text-align: left">cls</td>
          <td style="text-align: left">清空当前屏幕区域</td>
      </tr>
      <tr>
          <td style="text-align: left">echo</td>
          <td style="text-align: left">打印参数.同Linux echo</td>
      </tr>
      <tr>
          <td style="text-align: left">grep</td>
          <td style="text-align: left">匹配查找.同Linux grep</td>
      </tr>
      <tr>
          <td style="text-align: left">help</td>
          <td style="text-align: left">查看命令帮助信息</td>
      </tr>
      <tr>
          <td style="text-align: left">history</td>
          <td style="text-align: left">打印命令历史</td>
      </tr>
      <tr>
          <td style="text-align: left">keymap</td>
          <td style="text-align: left">显示所有的快捷键</td>
      </tr>
      <tr>
          <td style="text-align: left">pwd</td>
          <td style="text-align: left">显示当前的工作路径.同Linux pwd</td>
      </tr>
      <tr>
          <td style="text-align: left">quit</td>
          <td style="text-align: left">退出当前Arthas客户端,其他Arthas客户端不受影响</td>
      </tr>
      <tr>
          <td style="text-align: left">reset</td>
          <td style="text-align: left">重置增强类,将被Arthas增强过的类全部还原,Arthas服务端关闭时会重置所有增强过的类</td>
      </tr>
      <tr>
          <td style="text-align: left">session</td>
          <td style="text-align: left">查看当前会话信息</td>
      </tr>
      <tr>
          <td style="text-align: left">stop</td>
          <td style="text-align: left">关闭Arthas服务端,所有Arthas客户端全部退出</td>
      </tr>
      <tr>
          <td style="text-align: left">tee</td>
          <td style="text-align: left">复制标准输入到标准输出和指定的文件.同Linux tee</td>
      </tr>
      <tr>
          <td style="text-align: left">version</td>
          <td style="text-align: left">输出当前目标Java进程所加载的Arthas版本号</td>
      </tr>
  </tbody>
</table>
<h2 id="jvm命令" class="heading-element"><span>JVM命令</span>
  <a href="#jvm%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><table>
  <thead>
      <tr>
          <th style="text-align: left">jvm相关命令</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">dashboard</td>
          <td style="text-align: left">当前系统的实时数据面板</td>
      </tr>
      <tr>
          <td style="text-align: left">getstatic</td>
          <td style="text-align: left">查看类的静态属性</td>
      </tr>
      <tr>
          <td style="text-align: left">heapdump</td>
          <td style="text-align: left">dump java heap,类似jmap命令的heap dump功能</td>
      </tr>
      <tr>
          <td style="text-align: left">jvm</td>
          <td style="text-align: left">查看JVM信息</td>
      </tr>
      <tr>
          <td style="text-align: left">logger</td>
          <td style="text-align: left">查看和修改logger</td>
      </tr>
      <tr>
          <td style="text-align: left">mbean</td>
          <td style="text-align: left">查看Mbean信息</td>
      </tr>
      <tr>
          <td style="text-align: left">memory</td>
          <td style="text-align: left">查看JVM的内存信息</td>
      </tr>
      <tr>
          <td style="text-align: left">ognl</td>
          <td style="text-align: left">执行ognl表达式</td>
      </tr>
      <tr>
          <td style="text-align: left">perfcounter</td>
          <td style="text-align: left">查看当前JVM的Perf Counter信息</td>
      </tr>
      <tr>
          <td style="text-align: left">sysenv</td>
          <td style="text-align: left">查看JVM的环境变量</td>
      </tr>
      <tr>
          <td style="text-align: left">sysprop</td>
          <td style="text-align: left">查看和修改JVM系统属性</td>
      </tr>
      <tr>
          <td style="text-align: left">thread</td>
          <td style="text-align: left">查看当前JVM线程堆栈信息</td>
      </tr>
      <tr>
          <td style="text-align: left">vmoption</td>
          <td style="text-align: left">查看和修改JVM里诊断相关的option</td>
      </tr>
      <tr>
          <td style="text-align: left">vmtool</td>
          <td style="text-align: left">从jvm里查询对象,执行forceGc</td>
      </tr>
  </tbody>
</table>
<h2 id="classclassloader命令" class="heading-element"><span>Class/Classloader命令</span>
  <a href="#classclassloader%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><table>
  <thead>
      <tr>
          <th style="text-align: left">类，类加载相关的命令</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">sc</td>
          <td style="text-align: left">查看JVM已加载的类信息</td>
      </tr>
      <tr>
          <td style="text-align: left">sm</td>
          <td style="text-align: left">查看已加载类的方法信息</td>
      </tr>
      <tr>
          <td style="text-align: left">jad</td>
          <td style="text-align: left">反编译字节码为源代码</td>
      </tr>
      <tr>
          <td style="text-align: left">mc</td>
          <td style="text-align: left">内存编译器,内存编译.java文件为.class文件</td>
      </tr>
      <tr>
          <td style="text-align: left">redefine</td>
          <td style="text-align: left">加载外部的.class文件,redefine到JVM里</td>
      </tr>
      <tr>
          <td style="text-align: left">retransform</td>
          <td style="text-align: left">加载外部的.class文件,retransform到JVM里(推荐)</td>
      </tr>
      <tr>
          <td style="text-align: left">dump</td>
          <td style="text-align: left">dump已加载类的byte code到特定目录</td>
      </tr>
      <tr>
          <td style="text-align: left">classloader</td>
          <td style="text-align: left">获取类加载器信息</td>
      </tr>
  </tbody>
</table>
<h3 id="sc" class="heading-element"><span>sc</span>
  <a href="#sc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>查看JVM已加载的类信息,&ldquo;Search-Class&quot;的简写,这个命令能搜索出所有已经加载到JVM中的Class信息.</p>
<p>sc默认开启了子类匹配功能,也就是说所有当前类的子类也会被搜索出来,想要精确的匹配,可以执行下述命令.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">options disable-sub-class true</span></span></code></pre></td></tr></table>
</div>
</div><p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">class-pattern</td>
          <td style="text-align: left">类名表达式匹配,支持全限定名,如com.luohun.test.AAA,也支持com/luohun/test/AAA这样的格式</td>
      </tr>
      <tr>
          <td style="text-align: left">method-pattern</td>
          <td style="text-align: left">方法名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[d]</td>
          <td style="text-align: left">输出当前类的详细信息,包括这个类所加载的原始文件来源、类的声明、加载的ClassLoader等详细信息. 如果一个类被多个ClassLoader所加载,则会出现多次</td>
      </tr>
      <tr>
          <td style="text-align: left">[E]</td>
          <td style="text-align: left">开启正则表达式匹配，默认为通配符匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[f]</td>
          <td style="text-align: left">输出当前类的成员变量信息(需要配合参数-d一起使用)</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//模糊搜索，demo包下所有的类</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">sc</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//打印类的详细信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">sc</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/sc.png" alt="sc" srcset="./images/sc.png?size=small, ./images/sc.png?size=medium 1.5x, ./images/sc.png?size=large 2x" data-title="sc" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="sm" class="heading-element"><span>sm</span>
  <a href="#sm" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>查看已加载类的方法信息,&ldquo;Search-Method&quot;的简写,这个命令能搜索出所有已经加载了Class信息的方法信息.但是只能看到由当前类所声明(declaring)的方法,父类则无法看到.</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">class-pattern</td>
          <td style="text-align: left">类名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">method-pattern</td>
          <td style="text-align: left">方法名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[d]</td>
          <td style="text-align: left">展示每个方法的详细信息</td>
      </tr>
      <tr>
          <td style="text-align: left">[E]</td>
          <td style="text-align: left">开启正则表达式匹配，默认为通配符匹配</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//显示String类加载的方法</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">sm</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">String</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//显示String中的toString方法详细信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">sm</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">String</span><span class="w"> </span><span class="n">toString</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/sm.png" alt="sm" srcset="./images/sm.png?size=small, ./images/sm.png?size=medium 1.5x, ./images/sm.png?size=large 2x" data-title="sm" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="jad" class="heading-element"><span>jad</span>
  <a href="#jad" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>反编译字节码为源代码.</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">class-pattern</td>
          <td style="text-align: left">类名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[E]</td>
          <td style="text-align: left">开启正则表达式匹配，默认为通配符匹配</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//编译java.lang.String</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">jad</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">String</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//反编绎时只显示源代码,默认情况下,反编译结果里会带有ClassLoader信息,通过--source-only选项,可以只打印源代码.方便和mc/redefine命令结合使用.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">jad</span><span class="w"> </span><span class="o">--</span><span class="n">source</span><span class="o">-</span><span class="n">only</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">XiaLuoHun</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">jad</span><span class="o">/</span><span class="n">MathGame</span><span class="p">.</span><span class="na">java</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//反编译指定的函数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">jad</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">main</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/jad.png" alt="jad" srcset="./images/jad.png?size=small, ./images/jad.png?size=medium 1.5x, ./images/jad.png?size=large 2x" data-title="jad" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="mc" class="heading-element"><span>mc</span>
  <a href="#mc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>Memory Compiler/内存编译器,编译.java文件生成.class</p>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//在内存中编译Hello.java为Hello.class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mc</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">XiaLuoHun</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">jad</span><span class="o">/</span><span class="n">MathGame</span><span class="p">.</span><span class="na">java</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//可以通过-d命令指定输出目录</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mc</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">XiaLuoHun</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">jad</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">XiaLuoHun</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">jad</span><span class="o">/</span><span class="n">MathGame</span><span class="p">.</span><span class="na">java</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/mc.png" alt="mc" srcset="./images/mc.png?size=small, ./images/mc.png?size=medium 1.5x, ./images/mc.png?size=large 2x" data-title="mc" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="redefine" class="heading-element"><span>redefine</span>
  <a href="#redefine" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>加载外部的.class文件,推荐使用retransform</p>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//使用redefine命令加载新的字节码</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">redefine</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">XiaLuoHun</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">jad</span><span class="o">/</span><span class="n">demo</span><span class="o">/</span><span class="n">MathGame</span><span class="p">.</span><span class="na">class</span></span></span></code></pre></td></tr></table>
</div>
</div><p>redefine的限制如下:</p>
<ul>
<li>不允许新增加field/method</li>
<li>正在跑的函数,没有退出不能生效,比如下面新增加的System.out.println,只有run()函数里的会生效</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MathGame</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">MathGame</span><span class="w"> </span><span class="n">game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MathGame</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">game</span><span class="p">.</span><span class="na">run</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 这个不生效，因为代码一直跑在 while里</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;in loop&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 这个生效，因为run()函数每次都可以完整结束</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;call run()&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">primeFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">primeFactors</span><span class="p">(</span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">print</span><span class="p">(</span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">primeFactors</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&#34;illegalArgumentCount:%3d, &#34;</span><span class="p">,</span><span class="w"> </span><span class="n">illegalArgumentCount</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition note open">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-pencil-alt" aria-hidden="true"></i>注意<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content"><ul>
<li>
<p>redefine后的原来的类不能恢复,redefine有可能失败(比如增加了新的field)</p>
</li>
<li>
<p>reset命令对redefine的类无效.如果想重置,需要redefine原始的字节码</p>
</li>
<li>
<p>redefine命令和jad/watch/trace/monitor/tt等命令会冲突.执行完redefine之后,如果再执行上面提到的命令,则会把redefine的字节码重置</p>
</li>
</ul>
</div>
  </div>
</div>
<h3 id="retransform" class="heading-element"><span>retransform</span>
  <a href="#retransform" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>加载外部的.class文件</p>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//加载指定的.class文件,然后解析出class name,再retransform jvm中已加载的对应的类</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//每加载一个.class 文件,则会记录一个retransform entry</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">retransform</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">XiaLuoHun</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">jad</span><span class="o">/</span><span class="n">demo</span><span class="o">/</span><span class="n">MathGame</span><span class="p">.</span><span class="na">class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//查看retransform entry</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">retransform</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//删除指定retransform entry</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">retransform</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//删除所有retransform entry</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">retransform</span><span class="w"> </span><span class="o">--</span><span class="n">deleteAll</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//显式触发 retransform</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">retransform</span><span class="w"> </span><span class="o">--</span><span class="n">classPattern</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span></span></span></code></pre></td></tr></table>
</div>
</div><p>若要消除retransform的影响需进行下述步骤:</p>
<ol>
<li>删除这个类对应的retransform entry</li>
<li>重新触发retransform</li>
</ol>
<p>retransform的限制如下:</p>
<ul>
<li>不允许新增加field/method</li>
<li>正在跑的函数,没有退出不能生效,比如下面新增加的System.out.println,只有run()函数里的会生效</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">MathGame</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="nx">void</span> <span class="nx">main</span><span class="p">(</span><span class="nx">String</span><span class="p">[]</span> <span class="nx">args</span><span class="p">)</span> <span class="nx">throws</span> <span class="nx">InterruptedException</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">MathGame</span> <span class="nx">game</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathGame</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">game</span><span class="o">.</span><span class="nx">run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="nx">TimeUnit</span><span class="o">.</span><span class="nx">SECONDS</span><span class="o">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 这个不生效，因为代码一直跑在 while里
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">System</span><span class="o">.</span><span class="nx">out</span><span class="o">.</span><span class="nx">println</span><span class="p">(</span><span class="s2">&#34;in loop&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nx">void</span> <span class="nx">run</span><span class="p">()</span> <span class="nx">throws</span> <span class="nx">InterruptedException</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 这个生效，因为run()函数每次都可以完整结束
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">System</span><span class="o">.</span><span class="nx">out</span><span class="o">.</span><span class="nx">println</span><span class="p">(</span><span class="s2">&#34;call run()&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">int</span> <span class="nx">number</span> <span class="o">=</span> <span class="nx">random</span><span class="o">.</span><span class="nx">nextInt</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">List</span><span class="o">&lt;</span><span class="nx">Integer</span><span class="o">&gt;</span> <span class="nx">primeFactors</span> <span class="o">=</span> <span class="nx">primeFactors</span><span class="p">(</span><span class="nx">number</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">print</span><span class="p">(</span><span class="nx">number</span><span class="p">,</span> <span class="nx">primeFactors</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">System</span><span class="o">.</span><span class="nx">out</span><span class="o">.</span><span class="nx">println</span><span class="p">(</span><span class="nx">String</span><span class="o">.</span><span class="nx">format</span><span class="p">(</span><span class="s2">&#34;illegalArgumentCount:%3d, &#34;</span><span class="p">,</span> <span class="nx">illegalArgumentCount</span><span class="p">)</span> <span class="o">+</span> <span class="nx">e</span><span class="o">.</span><span class="nx">getMessage</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="dump" class="heading-element"><span>dump</span>
  <a href="#dump" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>将已加载类的字节码文件保存到特定目录:%HOMEPATH%/logs/arthas/classdump</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">class-pattern</td>
          <td style="text-align: left">类名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[c:]</td>
          <td style="text-align: left">类所属ClassLoader的hashcode</td>
      </tr>
      <tr>
          <td style="text-align: left">[E]</td>
          <td style="text-align: left">开启正则表达式匹配,默认为通配符匹配</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//把demo包下所有的类的字节码文件保存到~/logs/arthas/classdump/目录下</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">dump</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="o">*</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="classloader" class="heading-element"><span>classloader</span>
  <a href="#classloader" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>获取类加载器的信息</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">[l]</td>
          <td style="text-align: left">按类加载实例进行统计</td>
      </tr>
      <tr>
          <td style="text-align: left">[t]</td>
          <td style="text-align: left">打印所有ClassLoader的继承树</td>
      </tr>
      <tr>
          <td style="text-align: left">[a]</td>
          <td style="text-align: left">列出所有ClassLoader加载的类,请谨慎使用</td>
      </tr>
      <tr>
          <td style="text-align: left">[c:]</td>
          <td style="text-align: left">ClassLoader的hashcode</td>
      </tr>
      <tr>
          <td style="text-align: left">[c: r:]</td>
          <td style="text-align: left">用ClassLoader去查找resource</td>
      </tr>
      <tr>
          <td style="text-align: left">[c: load:]</td>
          <td style="text-align: left">用ClassLoader去加载指定的类</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//默认按类加载器的类型查看统计信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">classloader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//按类加载器的实例查看统计信息，可以看到类加载的hashCode</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">classloader</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//查看ClassLoader的继承树</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">classloader</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//通过类加载器的hash，查看此类加载器实际所在的位置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">classloader</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">798f84d5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//使用ClassLoader去查找类的class文件所在的位置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">classloader</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">798f84d5</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//使用ClassLoader去加载类</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">classloader</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">798f84d5</span><span class="w"> </span><span class="o">--</span><span class="n">load</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">String</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/classloader.png" alt="classloader" srcset="./images/classloader.png?size=small, ./images/classloader.png?size=medium 1.5x, ./images/classloader.png?size=large 2x" data-title="classloader" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="进阶命令" class="heading-element"><span>进阶命令</span>
  <a href="#%e8%bf%9b%e9%98%b6%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><table>
  <thead>
      <tr>
          <th style="text-align: left">命令</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">monitor</td>
          <td style="text-align: left">监控指定类中方法的执行情况</td>
      </tr>
      <tr>
          <td style="text-align: left">watch</td>
          <td style="text-align: left">观察到指定方法的调用情况</td>
      </tr>
      <tr>
          <td style="text-align: left">trace</td>
          <td style="text-align: left">对方法内部调用路径进行追踪,并输出方法路径上每个节点上耗时</td>
      </tr>
      <tr>
          <td style="text-align: left">stack</td>
          <td style="text-align: left">输出当前方法被调用的路径</td>
      </tr>
      <tr>
          <td style="text-align: left">tt</td>
          <td style="text-align: left">记录指定方法每次调用的入参和返回信息</td>
      </tr>
      <tr>
          <td style="text-align: left">options</td>
          <td style="text-align: left">全局开关</td>
      </tr>
  </tbody>
</table>
<h3 id="monitor" class="heading-element"><span>monitor</span>
  <a href="#monitor" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>监控指定类中方法的执行情况</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">class-pattern</td>
          <td style="text-align: left">类名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">method-pattern</td>
          <td style="text-align: left">方法名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[E]</td>
          <td style="text-align: left">开启正则表达式匹配,默认为通配符匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[c:]</td>
          <td style="text-align: left">统计周期,默认值为120秒</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//过5秒监控一次，类demo.MathGame中primeFactors方法</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">monitor</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">5</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">primeFactors</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/monitor.png" alt="monitor" srcset="./images/monitor.png?size=small, ./images/monitor.png?size=medium 1.5x, ./images/monitor.png?size=large 2x" data-title="monitor" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>监控项说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">监控项</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">timestamp</td>
          <td style="text-align: left">时间戳</td>
      </tr>
      <tr>
          <td style="text-align: left">class</td>
          <td style="text-align: left">Java类</td>
      </tr>
      <tr>
          <td style="text-align: left">method</td>
          <td style="text-align: left">方法(构造方法、普通方法)</td>
      </tr>
      <tr>
          <td style="text-align: left">total</td>
          <td style="text-align: left">调用次数</td>
      </tr>
      <tr>
          <td style="text-align: left">success</td>
          <td style="text-align: left">成功次数</td>
      </tr>
      <tr>
          <td style="text-align: left">fail</td>
          <td style="text-align: left">失败次数</td>
      </tr>
      <tr>
          <td style="text-align: left">rt</td>
          <td style="text-align: left">平均耗时</td>
      </tr>
      <tr>
          <td style="text-align: left">fail-rate</td>
          <td style="text-align: left">失败率</td>
      </tr>
  </tbody>
</table>
<h3 id="watch" class="heading-element"><span>watch</span>
  <a href="#watch" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>观察指定方法的调用情况</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">class-pattern</td>
          <td style="text-align: left">类名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">method-pattern</td>
          <td style="text-align: left">方法名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">express</td>
          <td style="text-align: left">观察表达式</td>
      </tr>
      <tr>
          <td style="text-align: left">condition-express</td>
          <td style="text-align: left">条件表达式</td>
      </tr>
      <tr>
          <td style="text-align: left">[b]</td>
          <td style="text-align: left">在<strong>方法调用之前</strong>观察before</td>
      </tr>
      <tr>
          <td style="text-align: left">[e]</td>
          <td style="text-align: left">在<strong>方法异常之后</strong>观察exception</td>
      </tr>
      <tr>
          <td style="text-align: left">[s]</td>
          <td style="text-align: left">在<strong>方法返回之后</strong>观察success</td>
      </tr>
      <tr>
          <td style="text-align: left">[f]</td>
          <td style="text-align: left">在<strong>方法结束之后</strong>(正常返回和异常返回)观察finish</td>
      </tr>
      <tr>
          <td style="text-align: left">[E]</td>
          <td style="text-align: left">开启正则表达式匹配,默认为通配符匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[x:]</td>
          <td style="text-align: left">指定输出结果的属性遍历深度,默认为1</td>
      </tr>
  </tbody>
</table>
<div class="details admonition note open">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-pencil-alt" aria-hidden="true"></i>注意<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content"><ul>
<li>watch 命令定义了4个观察事件点,即-b方法调用前,-e方法异常后,-s 方法返回后,-f方法结束后</li>
<li>4个观察事件点-b、-e、-s默认关闭,-f 默认打开,当指定观察点被打开后,在相应事件点会对观察表达式进行求值并输出</li>
<li>这里要注意方法入参和方法出参的区别,有可能在中间被修改导致前后不一致,除了-b事件点params代表方法入参外,其余事件都代表方法出参</li>
<li>当使用-b时,由于观察事件点是在方法调用前,此时返回值或异常均不存在</li>
</ul>
</div>
  </div>
</div>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//观察demo.MathGame类中primeFactors方法出参和返回值,结果属性遍历深度为2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//params表示所有参数数组(因为不确定是几个参数)，returnObject表示返回值</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">watch</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">primeFactors</span><span class="w"> </span><span class="s">&#34;{params,returnObj}&#34;</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">2</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/watch1.png" alt="watch1" srcset="./images/watch1.png?size=small, ./images/watch1.png?size=medium 1.5x, ./images/watch1.png?size=large 2x" data-title="watch1" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//观察方法入参,对比前一个例子,返回值为空(事件点为方法执行前,因此获取不到返回值)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">watch</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">primeFactors</span><span class="w"> </span><span class="s">&#34;{params,returnObj}&#34;</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">2</span><span class="w"> </span><span class="o">-</span><span class="n">b</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/watch2.png" alt="watch2" srcset="./images/watch2.png?size=small, ./images/watch2.png?size=medium 1.5x, ./images/watch2.png?size=large 2x" data-title="watch2" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//同时观察方法调用前和方法返回后,参数里-n 2,表示只执行两次</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//这里输出结果中,第一次输出的是方法调用前的观察表达式的结果,第二次输出的是方法返回后的表达式的结果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//params表示参数,target表示执行方法的对象,returnObject表示返回值</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">watch</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">primeFactors</span><span class="w"> </span><span class="s">&#34;{params,target,returnObj}&#34;</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">2</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">2</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/watch3.png" alt="watch3" srcset="./images/watch3.png?size=small, ./images/watch3.png?size=medium 1.5x, ./images/watch3.png?size=large 2x" data-title="watch3" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//条件表达式的例子，输出第1参数小于的情况</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">watch</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">primeFactors</span><span class="w"> </span><span class="s">&#34;{params[0],target}&#34;</span><span class="w"> </span><span class="s">&#34;params[0]&lt;0&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/watch4.png" alt="watch4" srcset="./images/watch4.png?size=small, ./images/watch4.png?size=medium 1.5x, ./images/watch4.png?size=large 2x" data-title="watch4" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="trace" class="heading-element"><span>trace</span>
  <a href="#trace" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>对方法内部调用路径进行追踪,并输出方法路径上的每个节点上耗时</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">class-pattern</td>
          <td style="text-align: left">类名表达匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">method-pattern</td>
          <td style="text-align: left">方法名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">condition-express</td>
          <td style="text-align: left">条件表达式,使用OGNL表达式</td>
      </tr>
      <tr>
          <td style="text-align: left">[E]</td>
          <td style="text-align: left">开启正则表达式匹配,默认是通配符匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[n:]</td>
          <td style="text-align: left">设置命令执行次数</td>
      </tr>
      <tr>
          <td style="text-align: left">#cost</td>
          <td style="text-align: left">方法执行耗时,单位是毫秒</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//trace函数指定类的指定方法</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">trace</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">run</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/trace1.png" alt="trace1" srcset="./images/trace1.png?size=small, ./images/trace1.png?size=medium 1.5x, ./images/trace1.png?size=large 2x" data-title="trace1" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//如果方法调用的次数很多,那么可以用-n参数指定捕捉结果的次数.比如下面的例子里,捕捉到一次调用就退出命令</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">trace</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">1</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/trace2.png" alt="trace2" srcset="./images/trace2.png?size=small, ./images/trace2.png?size=medium 1.5x, ./images/trace2.png?size=large 2x" data-title="trace2" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//默认情况下,trace不会包含jdk里的函数调用,如果希望trace jdk里的函数,需要显式设置--skipJDKMethod false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">trace</span><span class="w"> </span><span class="o">--</span><span class="n">skipJDKMethod</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">run</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/trace3.png" alt="trace3" srcset="./images/trace3.png?size=small, ./images/trace3.png?size=medium 1.5x, ./images/trace3.png?size=large 2x" data-title="trace3" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="stack" class="heading-element"><span>stack</span>
  <a href="#stack" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>输出当前方法被调用的调用路径</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">参数说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">class-pattern</td>
          <td style="text-align: left">类名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">method-pattern</td>
          <td style="text-align: left">方法名表达式匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">condition-express</td>
          <td style="text-align: left">条件表达式,OGNL</td>
      </tr>
      <tr>
          <td style="text-align: left">[E]</td>
          <td style="text-align: left">开启正则表达式匹配,默认为通配符匹配</td>
      </tr>
      <tr>
          <td style="text-align: left">[n:]</td>
          <td style="text-align: left">执行次数限制</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//获取primeFactors的调用路径</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stack</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">primeFactors</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/stack1.png" alt="stack1" srcset="./images/stack1.png?size=small, ./images/stack1.png?size=medium 1.5x, ./images/stack1.png?size=large 2x" data-title="stack1" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//条件表达式来过滤，第0个参数的值小于0，-n表示获取2次</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stack</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">primeFactors</span><span class="w"> </span><span class="err">&#39;</span><span class="n">params</span><span class="o">[</span><span class="n">0</span><span class="o">]&lt;</span><span class="n">0</span><span class="err">&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">2</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/stack2.png" alt="stack2" srcset="./images/stack2.png?size=small, ./images/stack2.png?size=medium 1.5x, ./images/stack2.png?size=large 2x" data-title="stack2" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="tt" class="heading-element"><span>tt</span>
  <a href="#tt" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>记录下指定方法每次调用的入参和返回信息,并能对这些不同时间下调用的信息进行观测</p>
<p>参数说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">参数名称</th>
          <th style="text-align: left">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">-t</td>
          <td style="text-align: left">记录某个方法在一个时间段中的调用</td>
      </tr>
      <tr>
          <td style="text-align: left">-l</td>
          <td style="text-align: left">显示所有已经记录的列表</td>
      </tr>
      <tr>
          <td style="text-align: left">-n 次数</td>
          <td style="text-align: left">只记录多少次</td>
      </tr>
      <tr>
          <td style="text-align: left">-s 表达式</td>
          <td style="text-align: left">搜索表达式</td>
      </tr>
      <tr>
          <td style="text-align: left">-i 索引号</td>
          <td style="text-align: left">查看指定索引号的详细调用信息</td>
      </tr>
      <tr>
          <td style="text-align: left">-p</td>
          <td style="text-align: left">重新调用指定的索引号时间碎片</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//记录下当前方法的每次调用环境现场。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">tt</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">demo</span><span class="p">.</span><span class="na">MathGame</span><span class="w"> </span><span class="n">primeFactors</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//检索调用记录</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">tt</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//筛选出primeFactors方法的调用信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">tt</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="err">&#39;</span><span class="n">method</span><span class="p">.</span><span class="na">name</span><span class="o">==</span><span class="s">&#34;primeFactors&#34;</span><span class="err">&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//查看调用信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//-i 参数后边跟着对应的INDEX编号查看到详细信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">tt</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">1002</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//重做一次调用</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//tt命令由于保存了当时调用的所有现场信息,所以我们可以自己主动对一个INDEX编号的时间片自主发起一次调用,从而解放你的沟通成本</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//可以通过--replay-times指定调用次数,通过 `--replay-interval` 指定多次调用间隔(单位ms, 默认1000ms)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">tt</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">1002</span><span class="w"> </span><span class="o">-</span><span class="n">p</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="./images/tt1.png" alt="tt1" srcset="./images/tt1.png?size=small, ./images/tt1.png?size=medium 1.5x, ./images/tt1.png?size=large 2x" data-title="tt1" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="./images/tt2.png" alt="tt2" srcset="./images/tt2.png?size=small, ./images/tt2.png?size=medium 1.5x, ./images/tt2.png?size=large 2x" data-title="tt2" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>表格字段说明如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">表格字段</th>
          <th style="text-align: left">字段解释</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">INDEX</td>
          <td style="text-align: left">时间片段记录编号,每一个编号代表着一次调用,后续tt还有很多命令都是基于此编号指定记录操作,非常重要</td>
      </tr>
      <tr>
          <td style="text-align: left">TIMESTAMP</td>
          <td style="text-align: left">方法执行的本机时间,记录了这个时间片段所发生的本机时间</td>
      </tr>
      <tr>
          <td style="text-align: left">COST(ms)</td>
          <td style="text-align: left">方法执行的耗时</td>
      </tr>
      <tr>
          <td style="text-align: left">IS-RET</td>
          <td style="text-align: left">方法是否以正常返回的形式结束</td>
      </tr>
      <tr>
          <td style="text-align: left">IS-EXP</td>
          <td style="text-align: left">方法是否以抛异常的形式结束</td>
      </tr>
      <tr>
          <td style="text-align: left">OBJECT</td>
          <td style="text-align: left">执行对象的hashCode(),注意,曾经有人误认为是对象在JVM中的内存地址,但很遗憾他不是.但他能帮助你简单的标记当前执行方法的类实体</td>
      </tr>
      <tr>
          <td style="text-align: left">CLASS</td>
          <td style="text-align: left">执行的类名</td>
      </tr>
      <tr>
          <td style="text-align: left">METHOD</td>
          <td style="text-align: left">执行的方法名</td>
      </tr>
  </tbody>
</table>
<h3 id="options" class="heading-element"><span>options</span>
  <a href="#options" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>全局开关</p>
<p>全局选项如下:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">名称</th>
          <th style="text-align: left">默认值</th>
          <th style="text-align: left">描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">unsafe</td>
          <td style="text-align: left">false</td>
          <td style="text-align: left">是否支持对系统级别的类进行增强,打开该开关可能导致把JVM搞挂,请慎重选择!</td>
      </tr>
      <tr>
          <td style="text-align: left">dump</td>
          <td style="text-align: left">false</td>
          <td style="text-align: left">是否支持被增强了的类dump到外部文件中,如果打开开关,class文件会被dump到/${application dir}/arthas-class-dump/目录下,具体位置详见控制台输出</td>
      </tr>
      <tr>
          <td style="text-align: left">batch-re-transform</td>
          <td style="text-align: left">true</td>
          <td style="text-align: left">是否支持批量对匹配到的类执行retransform操作</td>
      </tr>
      <tr>
          <td style="text-align: left">json-format</td>
          <td style="text-align: left">false</td>
          <td style="text-align: left">是否支持json化的输出</td>
      </tr>
      <tr>
          <td style="text-align: left">disable-sub-class</td>
          <td style="text-align: left">false</td>
          <td style="text-align: left">是否禁用子类匹配,默认在匹配目标类的时候会默认匹配到其子类,如果想精确匹配,可以关闭此开关</td>
      </tr>
      <tr>
          <td style="text-align: left">debug-for-asm</td>
          <td style="text-align: left">false</td>
          <td style="text-align: left">打印ASM相关的调试信息</td>
      </tr>
      <tr>
          <td style="text-align: left">save-result</td>
          <td style="text-align: left">false</td>
          <td style="text-align: left">是否打开执行结果存日志功能,打开之后所有命令的运行结果都将保存到~/logs/arthas-cache/result.log中</td>
      </tr>
      <tr>
          <td style="text-align: left">job-timeout</td>
          <td style="text-align: left">1d</td>
          <td style="text-align: left">异步后台任务的默认超时时间,超过这个时间,任务自动停止;比如设置 1d, 2h, 3m, 25s,分别代表天、小时、分、秒</td>
      </tr>
      <tr>
          <td style="text-align: left">print-parent-fields</td>
          <td style="text-align: left">true</td>
          <td style="text-align: left">是否打印在parent class里的filed</td>
      </tr>
  </tbody>
</table>
<p>示例命令如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//查看所有的options</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">options</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//获取option的值</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">options</span><span class="w"> </span><span class="n">json</span><span class="o">-</span><span class="n">format</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//设置指定的option</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">options</span><span class="w"> </span><span class="n">save</span><span class="o">-</span><span class="n">result</span><span class="w"> </span><span class="kc">true</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="参考链接" class="heading-element"><span>参考链接</span>
  <a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://arthas.aliyun.com/doc/"target="_blank" rel="external nofollow noopener noreferrer">Arthas帮助文档</a></p>
</div><hr class="awesome-hr" />
    <h2 id="see-also">相关内容</h2>
    <ul><li>
          <a href="/posts/web%E5%AE%89%E5%85%A8/dvwa%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="DVWA通关记录">DVWA通关记录</a></li><li>
          <a href="/posts/android/android%E5%A3%B3%E4%B8%96%E7%95%8C/android-dexvmp%E5%BF%AB%E9%80%9F%E5%88%86%E6%9E%90/" title="Android-DexVMP快速分析">Android-DexVMP快速分析</a></li><li>
          <a href="/posts/llvm/%E7%A7%BB%E6%A4%8Dollvm%E5%88%B0ndk%E4%B8%AD/" title="移植OLLVM到NDK中">移植OLLVM到NDK中</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2024-06-11 00:00:00">更新于 2024-06-11&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/java/" class="post-tag" title="标签 - Java">Java</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/web%E5%AE%89%E5%85%A8/dvwa%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" class="post-nav-item" rel="prev" title="DVWA通关记录"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>DVWA通关记录</a><a href="/posts/x64dbg/x64dbg-%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/" class="post-nav-item" rel="next" title="X64Dbg-命令详解">X64Dbg-命令详解<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2020 - 2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/">夏洛魂</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;--bg-progress: #0076ff;--bg-progress-dark: #fff;"></div><noscript>
    <div class="noscript-warning">该网站在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="stylesheet" href="/lib/pace/themes/purple/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":200},"comment":{"enable":false},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":true,"fuseIndexURL":"/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":1,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"version":"v0.3.15"};</script><script src="/js/theme.min.js" defer></script><script src="/js/custom.min.js" defer></script></body>
</html>
