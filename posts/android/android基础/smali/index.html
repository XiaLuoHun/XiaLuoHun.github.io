<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Smali - 夏洛魂的个人博客</title><meta name="author" content="夏洛魂">
<meta name="author-link" content="">
<meta name="description" content="Smali是Android dex文件的反汇编. Dalvik 概述 Android移动设备平台的核心组成部分之一,支持已转换为.dex(即Dalvik Exe" /><meta name="keywords" content='Smali' />
  <meta itemprop="name" content="Smali">
  <meta itemprop="description" content="Smali是Android dex文件的反汇编. Dalvik 概述 Android移动设备平台的核心组成部分之一,支持已转换为.dex(即Dalvik Exe">
  <meta itemprop="datePublished" content="2021-09-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-09-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="6315">
  <meta itemprop="image" content="https://XiaLuoHun.top/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AndroidMenifest%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8EDebug.png">
  <meta itemprop="keywords" content="Smali"><meta property="og:url" content="https://XiaLuoHun.top/posts/android/android%E5%9F%BA%E7%A1%80/smali/">
  <meta property="og:site_name" content="夏洛魂的个人博客">
  <meta property="og:title" content="Smali">
  <meta property="og:description" content="Smali是Android dex文件的反汇编. Dalvik 概述 Android移动设备平台的核心组成部分之一,支持已转换为.dex(即Dalvik Exe">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-09-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-09-05T00:00:00+00:00">
    <meta property="article:tag" content="Smali">
    <meta property="og:image" content="https://XiaLuoHun.top/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AndroidMenifest%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8EDebug.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://XiaLuoHun.top/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AndroidMenifest%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8EDebug.png">
  <meta name="twitter:title" content="Smali">
  <meta name="twitter:description" content="Smali是Android dex文件的反汇编. Dalvik 概述 Android移动设备平台的核心组成部分之一,支持已转换为.dex(即Dalvik Exe">
<meta name="application-name" content="夏洛魂">
<meta name="apple-mobile-web-app-title" content="夏洛魂"><meta name="theme-color" data-light="#ffffff" data-dark="#ffffff" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="canonical" href="https://XiaLuoHun.top/posts/android/android%E5%9F%BA%E7%A1%80/smali/" /><link rel="prev" href="https://XiaLuoHun.top/posts/%E5%B9%B3%E5%8F%B0api/github/" /><link rel="next" href="https://XiaLuoHun.top/posts/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/cobaltstrike/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Smali",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/XiaLuoHun.top\/posts\/android\/android%E5%9F%BA%E7%A1%80\/smali\/"
    },"image": [{
              "@type": "ImageObject",
              "url": "https:\/\/XiaLuoHun.top\/posts\/android\/android%E5%9F%BA%E7%A1%80\/smali\/images\/Smali\/AndroidMenifest%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8EDebug.png",
              "width":  1152 ,
              "height":  613 
            }],"genre": "posts","keywords": "Smali","wordcount":  6315 ,
    "url": "https:\/\/XiaLuoHun.top\/posts\/android\/android%E5%9F%BA%E7%A1%80\/smali\/","datePublished": "2021-09-05T00:00:00+00:00","dateModified": "2021-09-05T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "夏洛魂"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="夏洛魂的个人博客"><span class="header-title-text">夏洛魂</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              >文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              >标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              >分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/excalidraw/"
                
                
              >在线绘图</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              >关于作者</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="夏洛魂的个人博客"><span class="header-title-text">夏洛魂</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                >文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                >标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                >分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/excalidraw/"
                  
                  
                >在线绘图</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                >关于作者</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>Smali</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="/images/Luo.png" alt="夏洛魂" data-title="夏洛魂" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;夏洛魂</span></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/android%E5%9F%BA%E7%A1%80/" class="post-category" title="分类 - Android基础"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Android基础</a></span></div><div class="post-meta-line"><span title="发布于 2021-09-05 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2021-09-05">2021-09-05</time></span>&nbsp;<span title="6315 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 6400 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 13 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#dalvik">Dalvik</a>
              <ul>
                <li><a href="#概述">概述</a></li>
                <li><a href="#指令格式">指令格式</a></li>
                <li><a href="#字符串池">字符串池</a></li>
              </ul>
            </li>
            <li><a href="#dex反汇编工具">Dex反汇编工具</a></li>
            <li><a href="#smali汇编">Smali汇编</a>
              <ul>
                <li><a href="#概述-1">概述</a></li>
                <li><a href="#指令">指令</a>
                  <ul>
                    <li><a href="#nop">nop</a></li>
                    <li><a href="#move">move</a></li>
                    <li><a href="#return">return</a></li>
                    <li><a href="#const">const</a></li>
                    <li><a href="#monitor">monitor</a></li>
                    <li><a href="#check-case">check-case</a></li>
                    <li><a href="#instance-of">instance-of</a></li>
                    <li><a href="#new-instance">new-instance</a></li>
                    <li><a href="#数组">数组</a></li>
                    <li><a href="#分支">分支</a>
                      <ul>
                        <li><a href="#if">if</a></li>
                        <li><a href="#switch">Switch</a></li>
                        <li><a href="#for">for</a></li>
                        <li><a href="#while">while</a></li>
                        <li><a href="#do-while">do-while</a></li>
                      </ul>
                    </li>
                    <li><a href="#字段操作">字段操作</a></li>
                    <li><a href="#方法操作">方法操作</a></li>
                    <li><a href="#异常">异常</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#smali调试">Smali调试</a>
              <ul>
                <li><a href="#jdbexe">jdb.exe</a></li>
                <li><a href="#android调试运行">Android调试运行</a></li>
                <li><a href="#jeb">Jeb</a></li>
                <li><a href="#androidstudio">AndroidStudio</a></li>
                <li><a href="#反调试">反调试</a>
                  <ul>
                    <li><a href="#检测调试标志">检测调试标志</a></li>
                    <li><a href="#时间差">时间差</a></li>
                    <li><a href="#检测ida端口号23946">检测IDA端口号23946</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><p>Smali是Android dex文件的反汇编.</p>
<h3 id="dalvik" class="heading-element"><span>Dalvik</span>
  <a href="#dalvik" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="概述" class="heading-element"><span>概述</span>
  <a href="#%e6%a6%82%e8%bf%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ul>
<li>
<p>Android移动设备平台的核心组成部分之一,支持已转换为.dex(即Dalvik Executable)格式的Java应用程序的运行.</p>
</li>
<li>
<p>允许在有限的内存中同时运行多个虚拟机的实例,并且每一个Dalvik应用作为一个独立的Linux进程执行.</p>
</li>
<li>
<p>2014年6月5号,ART虚拟机代替Dalvik虚拟机.</p>
</li>
</ul>
<h4 id="指令格式" class="heading-element"><span>指令格式</span>
  <a href="#%e6%8c%87%e4%bb%a4%e6%a0%bc%e5%bc%8f" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>低版本NDK的源码中有Dalvik指令格式介绍,这里我们使用在线的Android源码查看Dalvik指令格式
<a href="http://androidxref.com/"target="_blank" rel="external nofollow noopener noreferrer">http://androidxref.com/</a></p>
<p><a href="/posts/android/android%E5%9F%BA%E7%A1%80/smali/Smali_Dalvik%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F.7z">Smali_Dalvik指令格式.7z</a></p>
<p>instruction-formats.html:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F1.png" alt="指令格式1" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F1.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F1.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F1.png?size=large 2x" data-title="指令格式1" style="--width: 1069px;--aspect-ratio: 1069 / 480;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F2.png" alt="指令格式2" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F2.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F2.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F2.png?size=large 2x" data-title="指令格式2" style="--width: 2453px;--aspect-ratio: 2453 / 1111;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>上图中,左侧每一个字母表示4位,空格表示16位.
中间一列的 22x
第一个2表示有几个16位, 第二个2表示有几个寄存器,第三个x表示没有附加数值.</p>
<p>dalvik-bytecode.html:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F3.png" alt="指令格式3" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F3.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F3.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F3.png?size=large 2x" data-title="指令格式3" style="--width: 2447px;--aspect-ratio: 2447 / 985;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>解析指令的时候,先根据op拿到指令格式,然后去instruction-formats.html查.</p>
<h4 id="字符串池" class="heading-element"><span>字符串池</span>
  <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%b1%a0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>例子：op VAA, string@BBBB
指令用到了1个寄存器参数vAA,并且还附加了一个字符串常量池索引string@BBBB</p>
<p>mov v0, &ldquo;Hello&rdquo;
mov v0, 0x12345678
以上两种对于解释执行的语言来说都是不可以的.
我们可以做个池,通常来说是个哈希表,如:
0 &ldquo;Hello Luo&rdquo;
1 &ldquo;HelloHun&rdquo;
代码就可以写成 mov v0, 0,但是这样无法区分是给数值0还是池的下标,
所有我们通常这样写,mov v0, string@0</p>
<h3 id="dex反汇编工具" class="heading-element"><span>Dex反汇编工具</span>
  <a href="#dex%e5%8f%8d%e6%b1%87%e7%bc%96%e5%b7%a5%e5%85%b7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>Dexdump:Android自带的,开源.</p>
<p>IDA:可以用来看Smali汇编.</p>
<p>dex2jar和jd-gui:Java字节码&ndash;&gt;Dex字节码,Dex字节码&ndash;&gt;Java字节码.Java有很多成熟的反编译工具,
我们可以利用dex2jar这个工具将Dex字节码转换为Java字节码,就可以使用Java的反编译工具了.</p>
<div class="details admonition note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>注意<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">d-gui的反编译结果不是很可靠.</div>
    </div>
  </div>
<p>JEB(神器):将IDA的每个字母加1就是JEB.Android版的IDA.</p>
<p>baksmali:反汇编Dex文件.</p>
<p>smali:将修改后的smali文件重新编译为Dex文件.通常我们使用Jeb寻找关键位置,然后baksmali修改,smali重新编译.
但是这样太麻烦了,就有了apktool.</p>
<p>apktool:Google提供的apk编译工具,内部用baksmail,加了资源的解析和编译.</p>
<h3 id="smali汇编" class="heading-element"><span>Smali汇编</span>
  <a href="#smali%e6%b1%87%e7%bc%96" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="概述-1" class="heading-element"><span>概述</span>
  <a href="#%e6%a6%82%e8%bf%b0-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>寄存器:</p>
<p>Dalvik是基于寄存器的虚拟机,没有栈,寄存器为v0-v65535.</p>
<p>不用任何寄存器存函数返回值.</p>
<p>类型表示:</p>
<table>
<thead>
<tr>
<th>语法</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>V</td>
<td>void</td>
</tr>
<tr>
<td>Z</td>
<td>boolean</td>
</tr>
<tr>
<td>B</td>
<td>byte</td>
</tr>
<tr>
<td>S</td>
<td>short</td>
</tr>
<tr>
<td>C</td>
<td>char</td>
</tr>
<tr>
<td>I</td>
<td>int</td>
</tr>
<tr>
<td>J</td>
<td>long</td>
</tr>
<tr>
<td>F</td>
<td>float</td>
</tr>
<tr>
<td>D</td>
<td>double</td>
</tr>
<tr>
<td>L</td>
<td>类类型</td>
</tr>
<tr>
<td>[</td>
<td>一维数组</td>
</tr>
<tr>
<td>[[</td>
<td>二维数组</td>
</tr>
<tr>
<td>[[[</td>
<td>三维数组</td>
</tr>
</tbody>
</table>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">myAdd</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span></span></span></code></pre></td></tr></table>
</div>
</div><p>方法表示:</p>
<p>Dalvik使用<strong>方法名</strong>,<strong>参数</strong>,<strong>返回值</strong>来描述一个方法.</p>
<p><strong>方法格式</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">LPackage/Name/ObjectName;-&gt;MethodName(III) Z
</span></span><span class="line"><span class="cl">LPackage/Name/ObjectName; : 类类型
</span></span><span class="line"><span class="cl">MethodName : 方法名
</span></span><span class="line"><span class="cl">(III) : 为参数类型(int,int,int)
</span></span><span class="line"><span class="cl">Z : 为返回值类型(boolean)</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nf">invoke-virtual</span> <span class="err">{</span><span class="no">p0</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span><span class="err">}</span><span class="p">,</span> <span class="no">Lorg</span><span class="err">/</span><span class="no">example</span><span class="err">/</span><span class="no">luotst</span><span class="err">/</span><span class="no">MainActivity</span><span class="err">;</span><span class="p">-</span><span class="err">&gt;</span><span class="no">myAdd</span><span class="p">(</span><span class="no">II</span><span class="p">)</span><span class="no">I</span></span></span></code></pre></td></tr></table>
</div>
</div><p>字段表示:</p>
<p>Dalvik使用<strong>类类型</strong>,<strong>字段名字</strong>,<strong>字段类型</strong>来描述一个字段.</p>
<p><strong>字段格式</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">LPackage/Name/ObjectName;-&gt;FieldName:Ljava/lang/String
</span></span><span class="line"><span class="cl">LPackage/Name/ObjectName; : 类类型
</span></span><span class="line"><span class="cl">FieldName : 为字段名称
</span></span><span class="line"><span class="cl">Ljava/lang/String : 为字段类型</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.line</span> <span class="mi">23</span>
</span></span><span class="line"><span class="cl"><span class="nf">const</span><span class="err">/</span><span class="mi">16</span> <span class="no">v0</span><span class="p">,</span> <span class="mi">0x14</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">iput</span> <span class="no">v0</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">Lorg</span><span class="err">/</span><span class="no">example</span><span class="err">/</span><span class="no">luotst</span><span class="err">/</span><span class="no">MainActivity</span><span class="c1">;-&gt;mData1:I
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="na">.line</span> <span class="mi">24</span>
</span></span><span class="line"><span class="cl"><span class="nf">const-string</span> <span class="no">v0</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">LuoHun</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">iput-object</span> <span class="no">v0</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">Lorg</span><span class="err">/</span><span class="no">example</span><span class="err">/</span><span class="no">luotst</span><span class="err">/</span><span class="no">MainActivity</span><span class="err">;</span><span class="p">-</span><span class="err">&gt;</span><span class="no">mData2</span><span class="p">:</span><span class="no">Ljava</span><span class="err">/</span><span class="no">lang</span><span class="err">/</span><span class="no">String</span><span class="err">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>参数与局部变量的区分:</p>
<p>Java代码:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">myAdd</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n2</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">20</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>对应的smali示例:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">myAdd</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v0</span><span class="p">,</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v1</span><span class="p">,</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">add-int</span>             <span class="no">v2</span><span class="p">,</span> <span class="no">p1</span><span class="p">,</span> <span class="no">p2</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">return</span>              <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上图中p1,p2是Jeb为我们显示的,这是P命名法,为了修改代码和我们识别函数参数方便而设计的,实际上是寄存器v4,v5.</p>
<p>smali中的局部变量使用的寄存器是V0-Vn,参数使用的寄存器是Vn+1-Vm.
从上图中可以看到用了6个寄存器,myAdd的参数声明中用了2个,加上this指针就是3个,也就是说v3-v5是参数,
从而推出v0-v2是局部变量,需要注意的是v3中存放的是this指针.
需要提一点的是,P命名法的好处,假如说我们新增了一个局部变量寄存器,这样的话,参数寄存器就会全变动,十分麻烦,使用P命名法,我们新增了一个局部变量寄存器,重新编译的时候,工具会帮我们自动将原来的参数寄存器加1.</p>
<h4 id="指令" class="heading-element"><span>指令</span>
  <a href="#%e6%8c%87%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>主要查看dalvik-bytecode.html文件.</p>
<h5 id="nop" class="heading-element"><span>nop</span>
  <a href="#nop" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p>空操作,通常是为了地址对齐.</p>
<h5 id="move" class="heading-element"><span>move</span>
  <a href="#move" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p>4字节整型传送:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move1.png" alt="move1" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move1.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move1.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move1.png?size=large 2x" data-title="move1" style="--width: 1142px;--aspect-ratio: 1142 / 211;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>Dalvik是基于寄存器的,没有栈的概念,全部用寄存器操作,寄存器最大有65536个.
上述第一条指令用4位表示寄存器,4位可表示的寄存器范围为v0-v15,
若是一个函数局部变量很多,寄存器使用超过了16个,第一条指令就放不下了,
所以有了第2和第3条指令.
/from表示源寄存器用16位表示
/16表示目标和源寄存器均用16位表示.</p>
<p>示例:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">int</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">20</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l2</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v0</span><span class="p">,</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v1</span><span class="p">,</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">move</span>                <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span></span></span></code></pre></td></tr></table>
</div>
</div><p>8字节整型传送:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move2.png" alt="move2" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move2.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move2.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move2.png?size=large 2x" data-title="move2" style="--width: 1176px;--aspect-ratio: 1176 / 261;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>寄存器是32位的,long是64位,一个寄存器放不下,所以用两个相邻的寄存器存放64位整型,
move-wide就是用来传送64位整型.</p>
<p>示例:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">long</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">long</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">20</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l2</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const-wide</span><span class="err">/</span><span class="mi">16</span>       <span class="no">v0</span><span class="p">,</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">const-wide</span><span class="err">/</span><span class="mi">16</span>       <span class="no">v2</span><span class="p">,</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">move-wide</span>           <span class="no">v0</span><span class="p">,</span> <span class="no">v2</span></span></span></code></pre></td></tr></table>
</div>
</div><p>对象传送:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move3.png" alt="move3" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move3.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move3.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move3.png?size=large 2x" data-title="move3" style="--width: 1139px;--aspect-ratio: 1139 / 211;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>mov-object用来传送类对象.</p>
<p>示例:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">MainActivity</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">move-object</span>         <span class="no">v4</span><span class="p">,</span> <span class="no">p0</span></span></span></code></pre></td></tr></table>
</div>
</div><p>取返回值:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move4.png" alt="move4" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move4.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move4.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move4.png?size=large 2x" data-title="move4" style="--width: 1177px;--aspect-ratio: 1177 / 296;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>在smali中,不用任何寄存器来存放函数的返回值,需要通过move-result来取函数的返回值.</p>
<p>示例:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">){</span><span class="w"> </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;onCreate&#34;</span><span class="p">);</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myAdd</span><span class="p">(</span><span class="n">100</span><span class="p">,</span><span class="w"> </span><span class="n">200</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">int</span><span class="w"> </span><span class="nf">myAdd</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n2</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">00000020</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v0</span><span class="p">,</span> <span class="mi">100</span>
</span></span><span class="line"><span class="cl"><span class="err">00000024</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v1</span><span class="p">,</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl"><span class="err">00000028</span>  <span class="nf">invoke-virtual</span>      <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">myAdd</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000002</span><span class="nf">E</span>  <span class="no">move-result</span>        <span class="no">v0</span></span></span></code></pre></td></tr></table>
</div>
</div><p>取异常:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move5.png" alt="move5" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move5.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move5.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/move5.png?size=large 2x" data-title="move5" style="--width: 1122px;--aspect-ratio: 1122 / 103;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>示例:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">ServerSocket</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ServerSocket</span><span class="p">(</span><span class="n">0x5566</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">:</span><span class="nf">try_0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">new-instance</span>        <span class="no">v0</span><span class="p">,</span> <span class="no">ServerSocket</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v1</span><span class="p">,</span> <span class="mi">0x5566</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">invoke-direct</span>       <span class="no">ServerSocket-</span><span class="err">&gt;&lt;</span><span class="no">init</span><span class="err">&gt;</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catch</span> <span class="no">IOException</span> <span class="err">{</span><span class="p">:</span><span class="no">try_0</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_E</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_10</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">tryend_E</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">E</span>  <span class="no">goto</span>                <span class="p">:</span><span class="mi">18</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_10</span>  <span class="c1"># used for: Ljava/io/IOException;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000010</span>  <span class="nf">move-exception</span>      <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">invoke-virtual</span>      <span class="no">IOException-</span><span class="err">&gt;</span><span class="no">printStackTrace</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">v0</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="return" class="heading-element"><span>return</span>
  <a href="#return" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/return.png" alt="return" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/return.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/return.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/return.png?size=large 2x" data-title="return" style="--width: 2368px;--aspect-ratio: 2368 / 166;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h5 id="const" class="heading-element"><span>const</span>
  <a href="#const" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/const.png" alt="const" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/const.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/const.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/const.png?size=large 2x" data-title="const" style="--width: 2364px;--aspect-ratio: 2364 / 789;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">int</span><span class="w"> </span><span class="n">n2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">16</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">int</span><span class="w"> </span><span class="n">n3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0x12345678</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">int</span><span class="w"> </span><span class="n">n4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0x14000000</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">long</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">long</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0x12345678</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;Hello Luo&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Class</span><span class="w"> </span><span class="n">cls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MainActivity</span><span class="p">.</span><span class="na">class</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v1</span><span class="p">,</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">const</span>               <span class="no">v2</span><span class="p">,</span> <span class="mi">305419896</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">const</span><span class="err">/</span><span class="no">high16</span>        <span class="no">v3</span><span class="p">,</span> <span class="mi">0x14000000</span>
</span></span><span class="line"><span class="cl"><span class="err">00000010</span>  <span class="nf">const-wide</span><span class="err">/</span><span class="mi">16</span>       <span class="no">v4</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000014</span>  <span class="nf">const-wide</span><span class="err">/</span><span class="mi">32</span>       <span class="no">v6</span><span class="p">,</span> <span class="mi">305419896</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">A</span>  <span class="no">const-string</span>        <span class="no">v8</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">Hello</span> <span class="no">Luo</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">E</span>  <span class="no">const-class</span>         <span class="no">v9</span><span class="p">,</span> <span class="no">MainActivity</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="monitor" class="heading-element"><span>monitor</span>
  <a href="#monitor" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/monitor.png" alt="monitor" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/monitor.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/monitor.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/monitor.png?size=large 2x" data-title="monitor" style="--width: 2367px;--aspect-ratio: 2367 / 288;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>同步指令.</p>
<p><strong>示例一</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">synchronized</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">myAdd</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">declared-synchronized</span> <span class="no">myAdd</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">monitor-enter</span>       <span class="no">p0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">add-int</span><span class="err">/</span><span class="mi">2</span><span class="no">addr</span>       <span class="no">p1</span><span class="p">,</span> <span class="no">p2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">monitor-exit</span>        <span class="no">p0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">return</span>              <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>示例二</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">mySub</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">mySub</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">monitor-enter</span>       <span class="no">p0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">sub-int</span><span class="err">/</span><span class="mi">2</span><span class="no">addr</span>       <span class="no">p1</span><span class="p">,</span> <span class="no">p2</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">try_4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">monitor-exit</span>        <span class="no">p0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">return</span>              <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_8</span>  <span class="c1"># used for: *
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000008</span>  <span class="nf">move-exception</span>      <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">monitor-exit</span>        <span class="no">p0</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catchall</span> <span class="err">{</span><span class="p">:</span><span class="no">try_4</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_C</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_8</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">tryend_C</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">throw</span>               <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这个地方多了一处monitor-exit,是为了防止代码进入同步区域后,代码崩了,无法退出同步.</p>
<h5 id="check-case" class="heading-element"><span>check-case</span>
  <a href="#check-case" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/check-case.png" alt="check-case" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/check-case.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/check-case.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/check-case.png?size=large 2x" data-title="check-case" style="--width: 2367px;--aspect-ratio: 2367 / 134;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>对象强转.</p>
<p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Case</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kt">int</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">f</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">MainActivity</span><span class="w"> </span><span class="n">n2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">MainActivity</span><span class="p">)</span><span class="n">obj</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">public</span> <span class="no">Case</span><span class="p">(</span><span class="no">Object</span><span class="p">,</span> <span class="no">F</span><span class="p">)</span><span class="no">V</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">float-to-int</span>        <span class="no">v0</span><span class="p">,</span> <span class="no">p2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">move-object</span>         <span class="no">v1</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">check-cast</span>          <span class="no">v1</span><span class="p">,</span> <span class="no">MainActivity</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">return-void</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="instance-of" class="heading-element"><span>instance-of</span>
  <a href="#instance-of" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/instance-of.png" alt="instance-of" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/instance-of.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/instance-of.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/instance-of.png?size=large 2x" data-title="instance-of" style="--width: 2370px;--aspect-ratio: 2370 / 134;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Case</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">MainActivity</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="n">MainActivity</span><span class="w"> </span><span class="n">n2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">MainActivity</span><span class="p">)</span><span class="n">obj</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">public</span> <span class="no">Case</span><span class="p">(</span><span class="no">Object</span><span class="p">,</span> <span class="no">F</span><span class="p">)</span><span class="no">V</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">instance-of</span>         <span class="no">v0</span><span class="p">,</span> <span class="no">p1</span><span class="p">,</span> <span class="no">MainActivity</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">if-eqz</span>              <span class="no">v0</span><span class="p">,</span> <span class="p">:</span><span class="no">E</span>
</span></span><span class="line"><span class="cl"><span class="err">:8</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">move-object</span>         <span class="no">v0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">check-cast</span>          <span class="no">v0</span><span class="p">,</span> <span class="no">MainActivity</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">E</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">E</span>  <span class="no">return-void</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="new-instance" class="heading-element"><span>new-instance</span>
  <a href="#new-instance" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/new-instance.png" alt="new-instance" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/new-instance.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/new-instance.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/new-instance.png?size=large 2x" data-title="new-instance" style="--width: 2368px;--aspect-ratio: 2368 / 70;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">MainActivity</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MainActivity</span><span class="p">();</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">new-instance</span>        <span class="no">v0</span><span class="p">,</span> <span class="no">MainActivity</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">invoke-direct</span>       <span class="no">MainActivity-</span><span class="err">&gt;&lt;</span><span class="no">init</span><span class="err">&gt;</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">v0</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="数组" class="heading-element"><span>数组</span>
  <a href="#%e6%95%b0%e7%bb%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%95%B0%E7%BB%841.png" alt="数组1" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%95%B0%E7%BB%841.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%95%B0%E7%BB%841.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%95%B0%E7%BB%841.png?size=large 2x" data-title="数组1" style="--width: 2364px;--aspect-ratio: 2364 / 528;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%95%B0%E7%BB%842.png" alt="数组2" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%95%B0%E7%BB%842.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%95%B0%E7%BB%842.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%95%B0%E7%BB%842.png?size=large 2x" data-title="数组2" style="--width: 2370px;--aspect-ratio: 2370 / 388;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><strong>示例一维数组</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">TstAry</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kt">short</span><span class="w"> </span><span class="n">nAry</span><span class="o">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">,</span><span class="w"> </span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="n">4</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nAry</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">nAry</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstAry</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>              <span class="no">v0</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">new-array</span>            <span class="no">v0</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="p">[</span><span class="no">S</span>    <span class="c1">//new一个数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000006</span>  <span class="nf">fill-array-data</span>      <span class="no">v0</span><span class="p">,</span> <span class="p">:</span><span class="mi">20</span>       <span class="c1">//初始化数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">0000000</span><span class="nf">C</span>  <span class="no">const</span><span class="err">/</span><span class="mi">4</span>              <span class="no">v1</span><span class="p">,</span> <span class="mi">2</span>          
</span></span><span class="line"><span class="cl"><span class="mi">0000000</span><span class="no">E</span>  <span class="no">aget-short</span>           <span class="no">v1</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>    <span class="c1">//v1表示数组序号,将数组中v1序号的值给v1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000012</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v2</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000014</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v3</span><span class="p">,</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="err">00000018</span>  <span class="nf">aput-short</span>           <span class="no">v3</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v2</span>    <span class="c1">//v2是数组序号,将数组中序号为v2中的值修改为v3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">0000001</span><span class="nf">C</span>  <span class="no">return</span>                <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">:20</span>
</span></span><span class="line"><span class="cl"><span class="err">00000020</span>  <span class="na">.array-data</span> <span class="mi">2</span> <span class="no">x</span> <span class="mi">0x4</span>
</span></span><span class="line"><span class="cl">              <span class="err">0</span><span class="nf">x1</span>
</span></span><span class="line"><span class="cl">              <span class="err">0</span><span class="nf">x2</span>
</span></span><span class="line"><span class="cl">              <span class="err">0</span><span class="nf">x3</span>
</span></span><span class="line"><span class="cl">              <span class="err">0</span><span class="nf">x4</span>
</span></span><span class="line"><span class="cl">          <span class="na">.end</span> <span class="no">array-data</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p>aget拿数组值,aput修改数组值.</p>
<p><strong>示例二维数组</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">TstAry</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kt">short</span><span class="w"> </span><span class="n">nAry</span><span class="o">[][]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="n">4</span><span class="p">}};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nAry</span><span class="o">[</span><span class="n">1</span><span class="o">][</span><span class="n">0</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">nAry</span><span class="o">[</span><span class="n">0</span><span class="o">][</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstAry</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">new-array</span>           <span class="no">v1</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="p">[[</span><span class="no">S</span>      <span class="c1">//new 一个一维数组v1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000006</span>  <span class="nf">new-array</span>           <span class="no">v2</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="p">[</span><span class="no">S</span>       <span class="c1">//new一个一维数组v2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">0000000</span><span class="nf">A</span>  <span class="no">fill-array-data</span>     <span class="no">v2</span><span class="p">,</span> <span class="p">:</span><span class="mi">40</span>          <span class="c1">//初始化一维数组v2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000010</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v3</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">aput-object</span>         <span class="no">v2</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="no">v3</span>      <span class="c1">//修改一维数组v1中序号为0的值为v2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000016</span>  <span class="nf">new-array</span>           <span class="no">v0</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="p">[</span><span class="no">S</span>       <span class="c1">//new一个一维数组v0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">0000001</span><span class="nf">A</span>  <span class="no">fill-array-data</span>     <span class="no">v0</span><span class="p">,</span> <span class="p">:</span><span class="mi">4</span><span class="no">C</span>          <span class="c1">//初始化一维数组v0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000020</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v2</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000022</span>  <span class="nf">aput-object</span>         <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="no">v2</span>      <span class="c1">//修改一维数组v1中序号为1的值为v0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000026</span>  <span class="nf">move-object</span>         <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000028</span>  <span class="nf">aget-object</span>         <span class="no">v1</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v2</span>      <span class="c1">//v2表示数组序号,将数组v0中序号为v2的值给v1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">0000002</span><span class="nf">C</span>  <span class="no">aget-short</span>          <span class="no">v1</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="no">v3</span>      <span class="c1">//v3表示数组序号,将数组v1中序号为v3的值给v1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000030</span>  <span class="nf">aget-object</span>         <span class="no">v3</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v3</span>     
</span></span><span class="line"><span class="cl"><span class="mi">00000034</span>  <span class="no">const</span><span class="err">/</span><span class="mi">16</span>           <span class="no">v4</span><span class="p">,</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="err">00000038</span>  <span class="nf">aput-short</span>          <span class="no">v4</span><span class="p">,</span> <span class="no">v3</span><span class="p">,</span> <span class="no">v2</span>     <span class="c1">//以上3句,等同于nAry[0][1] = 10;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">0000003</span><span class="nf">C</span>  <span class="no">return</span>              <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">:40</span>
</span></span><span class="line"><span class="cl"><span class="err">00000040</span>  <span class="na">.array-data</span> <span class="mi">2</span> <span class="no">x</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl">              <span class="err">0</span><span class="nf">x1</span>
</span></span><span class="line"><span class="cl">              <span class="err">0</span><span class="nf">x2</span>
</span></span><span class="line"><span class="cl">          <span class="na">.end</span> <span class="no">array-data</span>
</span></span><span class="line"><span class="cl"><span class="err">:4</span><span class="nf">C</span>
</span></span><span class="line"><span class="cl"><span class="err">0000004</span><span class="nf">C</span>  <span class="no">.array-data</span> <span class="mi">2</span> <span class="no">x</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl">              <span class="err">0</span><span class="nf">x3</span>
</span></span><span class="line"><span class="cl">              <span class="err">0</span><span class="nf">x4</span>
</span></span><span class="line"><span class="cl">          <span class="na">.end</span> <span class="no">array-data</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p>汇编中没有二维数组的概念,实际上是new一个一维数组,里面的元素是一维数组.</p>
<h5 id="分支" class="heading-element"><span>分支</span>
  <a href="#%e5%88%86%e6%94%af" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E5%88%86%E6%94%AF1.png" alt="分支1" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E5%88%86%E6%94%AF1.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E5%88%86%E6%94%AF1.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E5%88%86%E6%94%AF1.png?size=large 2x" data-title="分支1" style="--width: 2368px;--aspect-ratio: 2368 / 378;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h6 id="if" class="heading-element"><span>if</span>
  <a href="#if" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">TstIf</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="n">p1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="n">p2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstIf</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">if-le</span>               <span class="no">p1</span><span class="p">,</span> <span class="no">p2</span><span class="p">,</span> <span class="p">:</span><span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="err">:4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">return</span>              <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">:6</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">return</span>              <span class="no">p2</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="switch" class="heading-element"><span>Switch</span>
  <a href="#switch" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Switch.png" alt="Switch" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Switch.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Switch.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Switch.png?size=large 2x" data-title="Switch" style="--width: 2370px;--aspect-ratio: 2370 / 169;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>当case的数量不是很大的时候,会被优化成if-else,这种的下面不再演示.</p>
<p><strong>示例packed</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">TstCase</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">1</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">2</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">3</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">3</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">6</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">4</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">8</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">default</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">9</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstCase</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">packed-switch</span>       <span class="no">p1</span><span class="p">,</span> <span class="p">:</span><span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="err">:6</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v0</span><span class="p">,</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">C</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v0</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="err">00000010</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:12</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="err">00000014</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:16</span>
</span></span><span class="line"><span class="cl"><span class="err">00000016</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="err">00000018</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:1</span><span class="nf">A</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">A</span>  <span class="no">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">C</span>  <span class="no">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:20</span>
</span></span><span class="line"><span class="cl"><span class="err">00000020</span>  <span class="na">.packed-switch</span> <span class="mi">1</span>   <span class="c1">//从1开始计数, 相当于switch(p1 - 1)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="err">:1</span><span class="nf">A</span>
</span></span><span class="line"><span class="cl">              <span class="err">:16</span>
</span></span><span class="line"><span class="cl">              <span class="err">:12</span>
</span></span><span class="line"><span class="cl">              <span class="err">:</span><span class="nf">C</span>
</span></span><span class="line"><span class="cl">          <span class="na">.end</span> <span class="no">packed-switch</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>示例sparse</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">TstCase</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">1</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">3</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">3</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">6</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">6</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">8</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">8</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">default</span><span class="p">:{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">9</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstCase</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">sparse-switch</span>       <span class="no">p1</span><span class="p">,</span> <span class="p">:</span><span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="err">:6</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v0</span><span class="p">,</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">C</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v0</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="err">00000010</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:12</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="err">00000014</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:16</span>
</span></span><span class="line"><span class="cl"><span class="err">00000016</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="err">00000018</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:1</span><span class="nf">A</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">A</span>  <span class="no">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">C</span>  <span class="no">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:20</span>
</span></span><span class="line"><span class="cl"><span class="err">00000020</span>  <span class="na">.sparse-switch</span>
</span></span><span class="line"><span class="cl">              <span class="err">1</span> <span class="err">-&gt;</span> <span class="err">:1</span><span class="nf">A</span>
</span></span><span class="line"><span class="cl">              <span class="err">3</span> <span class="err">-&gt;</span> <span class="err">:16</span>
</span></span><span class="line"><span class="cl">              <span class="err">6</span> <span class="err">-&gt;</span> <span class="err">:12</span>
</span></span><span class="line"><span class="cl">              <span class="err">8</span> <span class="err">-&gt;</span> <span class="err">:</span><span class="nf">C</span>
</span></span><span class="line"><span class="cl">          <span class="na">.end</span> <span class="no">sparse-switch</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="for" class="heading-element"><span>for</span>
  <a href="#for" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><p><strong>示例常规</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">TstFor</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">nSum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">p1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">nSum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">nSum</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstFor</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v1</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err">:4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">if-ge</span>               <span class="no">v1</span><span class="p">,</span> <span class="no">p1</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="err">:8</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">add-int</span><span class="err">/</span><span class="mi">2</span><span class="no">addr</span>       <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">add-int</span><span class="err">/</span><span class="no">lit8</span>        <span class="no">v1</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">E</span>  <span class="no">goto</span>                <span class="p">:</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="err">:10</span>
</span></span><span class="line"><span class="cl"><span class="err">00000010</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>示例迭代器</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;onCreate&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">lst</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">lst</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">lst</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TstFor</span><span class="p">(</span><span class="n">lst</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="nf">TstFor</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lst</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">nSum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">lst</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">nSum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">nSum</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstFor</span><span class="p">(</span><span class="no">List</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">invoke-interface</span>    <span class="no">List-</span><span class="err">&gt;</span><span class="no">iterator</span><span class="p">()</span><span class="no">Iterator</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">move-result-object</span>  <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">A</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">invoke-interface</span>    <span class="no">Iterator-</span><span class="err">&gt;</span><span class="no">hasNext</span><span class="p">()</span><span class="no">Z</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000010</span>  <span class="nf">move-result</span>         <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">if-eqz</span>              <span class="no">v2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="no">E</span>
</span></span><span class="line"><span class="cl"><span class="err">:16</span>
</span></span><span class="line"><span class="cl"><span class="err">00000016</span>  <span class="nf">invoke-interface</span>    <span class="no">Iterator-</span><span class="err">&gt;</span><span class="no">next</span><span class="p">()</span><span class="no">Object</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">C</span>  <span class="no">move-result-object</span>  <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">E</span>  <span class="no">check-cast</span>          <span class="no">v2</span><span class="p">,</span> <span class="no">Integer</span>
</span></span><span class="line"><span class="cl"><span class="err">00000022</span>  <span class="nf">invoke-virtual</span>      <span class="no">Integer-</span><span class="err">&gt;</span><span class="no">intValue</span><span class="p">()</span><span class="no">I</span><span class="p">,</span> <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000028</span>  <span class="nf">move-result</span>         <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="err">0000002</span><span class="nf">A</span>  <span class="no">add-int</span><span class="err">/</span><span class="mi">2</span><span class="no">addr</span>       <span class="no">v0</span><span class="p">,</span> <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="err">0000002</span><span class="nf">C</span>  <span class="no">goto</span>                <span class="p">:</span><span class="no">A</span>
</span></span><span class="line"><span class="cl"><span class="err">:2</span><span class="nf">E</span>
</span></span><span class="line"><span class="cl"><span class="err">0000002</span><span class="nf">E</span>  <span class="no">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上述Smali汇编可以翻译为:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="n">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Iterator</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lst</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">hasNext</span><span class="p">()){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span><span class="n">it</span><span class="p">.</span><span class="na">next</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="na">intValue</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">v0</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">v2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">return</span><span class="w"> </span><span class="n">v0</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="n">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lst</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">hasNext</span><span class="p">()){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="na">next</span><span class="p">().</span><span class="na">intValue</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">v0</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">v2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">return</span><span class="w"> </span><span class="n">v0</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>需要注意的是</strong>,这种带模板的,Jeb是没办法还原成上述的原始Java代码的.</p>
<h6 id="while" class="heading-element"><span>while</span>
  <a href="#while" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">TstWhile</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nSum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">20</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">nSum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">p1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">p1</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">nSum</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstWhile</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err">:2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v1</span><span class="p">,</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">if-ge</span>               <span class="no">p1</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="p">:</span><span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">A</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">add-int</span><span class="err">/</span><span class="mi">2</span><span class="no">addr</span>       <span class="no">v0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">add-int</span><span class="err">/</span><span class="no">lit8</span>        <span class="no">p1</span><span class="p">,</span> <span class="no">p1</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000010</span>  <span class="nf">goto</span>                <span class="p">:</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="err">:12</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="do-while" class="heading-element"><span>do-while</span>
  <a href="#do-while" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="w"> </span><span class="nf">TstDoWhile</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nSum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">do</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">nSum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">p1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">p1</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">nSum</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">TstDoWhile</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">I</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err">:2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000002</span>  <span class="nf">add-int</span><span class="err">/</span><span class="mi">2</span><span class="no">addr</span>       <span class="no">v0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">add-int</span><span class="err">/</span><span class="no">lit8</span>        <span class="no">p1</span><span class="p">,</span> <span class="no">p1</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v1</span><span class="p">,</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">if-lt</span>                <span class="no">p1</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="p">:</span><span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="err">:10</span>
</span></span><span class="line"><span class="cl"><span class="err">00000010</span>  <span class="nf">return</span>              <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">:12</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">goto</span>                <span class="p">:</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="字段操作" class="heading-element"><span>字段操作</span>
  <a href="#%e5%ad%97%e6%ae%b5%e6%93%8d%e4%bd%9c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p>非静态字段:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E9%9D%9E%E9%9D%99%E6%80%81%E5%AD%97%E6%AE%B5.png" alt="非静态字段" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E9%9D%9E%E9%9D%99%E6%80%81%E5%AD%97%E6%AE%B5.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E9%9D%9E%E9%9D%99%E6%80%81%E5%AD%97%E6%AE%B5.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E9%9D%9E%E9%9D%99%E6%80%81%E5%AD%97%E6%AE%B5.png?size=large 2x" data-title="非静态字段" style="--width: 2369px;--aspect-ratio: 2369 / 388;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>iget,非静态字段赋值.
iput,给静态字段赋值.</p>
<p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">mData1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">mData2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">3</span><span class="p">.</span><span class="na">5f</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">mData3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mData1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mData2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mData3</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">.</span><span class="n">method</span> <span class="n">public</span> <span class="n">constructor</span> <span class="o">&lt;</span><span class="n">init</span><span class="o">&gt;</span><span class="p">()</span><span class="n">V</span>
</span></span><span class="line"><span class="cl">          <span class="o">.</span><span class="n">registers</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000000</span>  <span class="n">invoke</span><span class="o">-</span><span class="n">direct</span>       <span class="n">AppCompatActivity</span><span class="o">-&gt;&lt;</span><span class="n">init</span><span class="o">&gt;</span><span class="p">()</span><span class="n">V</span><span class="p">,</span> <span class="n">p0</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000006</span>  <span class="k">const</span><span class="o">/</span><span class="mi">4</span>             <span class="n">v0</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000008</span>  <span class="n">iput</span>                <span class="n">v0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">MainActivity</span><span class="o">-&gt;</span><span class="n">mData1</span><span class="p">:</span><span class="n">I</span>
</span></span><span class="line"><span class="cl"><span class="mi">0000000</span><span class="n">C</span>  <span class="k">const</span><span class="o">/</span><span class="n">high16</span>        <span class="n">v0</span><span class="p">,</span> <span class="mh">0x40600000</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000010</span>  <span class="n">iput</span>                <span class="n">v0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">MainActivity</span><span class="o">-&gt;</span><span class="n">mData2</span><span class="p">:</span><span class="n">F</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000014</span>  <span class="k">const</span><span class="o">/</span><span class="mi">4</span>             <span class="n">v0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000016</span>  <span class="n">iput</span><span class="o">-</span><span class="n">object</span>         <span class="n">v0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">MainActivity</span><span class="o">-&gt;</span><span class="n">mData3</span><span class="p">:</span><span class="ne">Object</span>
</span></span><span class="line"><span class="cl"><span class="mi">0000001</span><span class="n">A</span>  <span class="k">return</span><span class="o">-</span><span class="n">void</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">end</span> <span class="n">method</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">protected</span> <span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">invoke-super</span>        <span class="no">AppCompatActivity-</span><span class="err">&gt;</span><span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">const</span>               <span class="no">v0</span><span class="p">,</span> <span class="mi">0x7F0B001C</span> 
</span></span><span class="line"><span class="cl"><span class="mi">0000000</span><span class="no">C</span>  <span class="no">invoke-virtual</span>      <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">setContentView</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">v0</span> 
</span></span><span class="line"><span class="cl"><span class="mi">00000012</span>  <span class="no">iget</span>                <span class="no">v0</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">mData1</span><span class="p">:</span><span class="no">I</span>
</span></span><span class="line"><span class="cl"><span class="err">00000016</span>  <span class="nf">iget</span>                <span class="no">v1</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">mData2</span><span class="p">:</span><span class="no">F</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">A</span>  <span class="no">iget-object</span>         <span class="no">v2</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">mData3</span><span class="p">:</span><span class="no">Object</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">E</span>  <span class="no">return-void</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p>静态字段:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E9%9D%99%E6%80%81%E5%AD%97%E6%AE%B5.png" alt="静态字段" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E9%9D%99%E6%80%81%E5%AD%97%E6%AE%B5.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E9%9D%99%E6%80%81%E5%AD%97%E6%AE%B5.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E9%9D%99%E6%80%81%E5%AD%97%E6%AE%B5.png?size=large 2x" data-title="静态字段" style="--width: 2369px;--aspect-ratio: 2369 / 388;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>sget,静态字段赋值.
sput,给静态字段赋值.</p>
<p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">mData1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">mData2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">3</span><span class="p">.</span><span class="na">5f</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">mData3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mData1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mData2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mData3</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">.</span><span class="n">method</span> <span class="k">static</span> <span class="n">constructor</span> <span class="o">&lt;</span><span class="n">clinit</span><span class="o">&gt;</span><span class="p">()</span><span class="n">V</span>
</span></span><span class="line"><span class="cl">          <span class="o">.</span><span class="n">registers</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000000</span>  <span class="k">const</span><span class="o">/</span><span class="mi">4</span>             <span class="n">v0</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000002</span>  <span class="n">sput</span>                <span class="n">v0</span><span class="p">,</span> <span class="n">MainActivity</span><span class="o">-&gt;</span><span class="n">mData1</span><span class="p">:</span><span class="n">I</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000006</span>  <span class="k">const</span><span class="o">/</span><span class="n">high16</span>        <span class="n">v0</span><span class="p">,</span> <span class="mh">0x40600000</span>
</span></span><span class="line"><span class="cl"><span class="mi">0000000</span><span class="n">A</span>  <span class="n">sput</span>                <span class="n">v0</span><span class="p">,</span> <span class="n">MainActivity</span><span class="o">-&gt;</span><span class="n">mData2</span><span class="p">:</span><span class="n">F</span>
</span></span><span class="line"><span class="cl"><span class="mi">0000000</span><span class="n">E</span>  <span class="k">const</span><span class="o">/</span><span class="mi">4</span>             <span class="n">v0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000010</span>  <span class="n">sput</span><span class="o">-</span><span class="n">object</span>         <span class="n">v0</span><span class="p">,</span> <span class="n">MainActivity</span><span class="o">-&gt;</span><span class="n">mData3</span><span class="p">:</span><span class="ne">Object</span>
</span></span><span class="line"><span class="cl"><span class="mi">00000014</span>  <span class="k">return</span><span class="o">-</span><span class="n">void</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">end</span> <span class="n">method</span></span></span></code></pre></td></tr></table>
</div>
</div><p>静态字段的初始化,在clinit中.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">protected</span> <span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">invoke-super</span>        <span class="no">AppCompatActivity-</span><span class="err">&gt;</span><span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">const</span>               <span class="no">v0</span><span class="p">,</span> <span class="mi">0x7F0B001C</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">invoke-virtual</span>      <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">setContentView</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">sget</span>                <span class="no">v0</span><span class="p">,</span> <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">mData1</span><span class="p">:</span><span class="no">I</span>
</span></span><span class="line"><span class="cl"><span class="err">00000016</span>  <span class="nf">sget</span>                <span class="no">v1</span><span class="p">,</span> <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">mData2</span><span class="p">:</span><span class="no">F</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">A</span>  <span class="no">sget-object</span>         <span class="no">v2</span><span class="p">,</span> <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">mData3</span><span class="p">:</span><span class="no">Object</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">E</span>  <span class="no">return-void</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="方法操作" class="heading-element"><span>方法操作</span>
  <a href="#%e6%96%b9%e6%b3%95%e6%93%8d%e4%bd%9c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%96%B9%E6%B3%95%E6%93%8D%E4%BD%9C.png" alt="方法操作" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%96%B9%E6%B3%95%E6%93%8D%E4%BD%9C.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%96%B9%E6%B3%95%E6%93%8D%E4%BD%9C.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%96%B9%E6%B3%95%E6%93%8D%E4%BD%9C.png?size=large 2x" data-title="方法操作" style="--width: 2370px;--aspect-ratio: 2370 / 164;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>分别对应 虚函数、调父类方法、直接方法、静态方法、接口.
其中直接方法只有两种情况,①构造.②私有.</p>
<p><strong>示例</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">mySub</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">n1</span><span class="o">-</span><span class="w"> </span><span class="n">n2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mySub</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="n">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Samli:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">protected</span> <span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">invoke-super</span>        <span class="no">AppCompatActivity-</span><span class="err">&gt;</span><span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000006</span>  <span class="nf">const</span>               <span class="no">v0</span><span class="p">,</span> <span class="mi">0x7F0B001C</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">C</span>  <span class="no">invoke-virtual</span>      <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">setContentView</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000012</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">16</span>            <span class="no">v0</span><span class="p">,</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="err">00000016</span>  <span class="nf">const</span><span class="err">/</span><span class="mi">4</span>             <span class="no">v1</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="err">00000018</span>  <span class="nf">invoke-direct</span>       <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">mySub</span><span class="p">(</span><span class="no">I</span><span class="p">,</span> <span class="no">I</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">E</span>  <span class="no">move-result</span>         <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000020</span>  <span class="nf">return-void</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="异常" class="heading-element"><span>异常</span>
  <a href="#%e5%bc%82%e5%b8%b8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><strong>示例 try-catch</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Exception1</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayIndexOutOfBoundsException</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Exception1</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ArrayIndexOutOfBoundsException</span><span class="w"> </span><span class="n">e</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&#34;Luo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;ArrayIndexOutOfBoundsException&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&#34;Luo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Exception&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">throwable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&#34;Luo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Throwable&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">throwable</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">protected</span> <span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const-string</span>        <span class="no">v0</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">Luo</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">invoke-super</span>        <span class="no">AppCompatActivity-</span><span class="err">&gt;</span><span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">A</span>  <span class="no">const</span>               <span class="no">p1</span><span class="p">,</span> <span class="mi">0x7F0B001C</span>
</span></span><span class="line"><span class="cl"><span class="err">00000010</span>  <span class="nf">invoke-virtual</span>      <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">setContentView</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">try_16</span>
</span></span><span class="line"><span class="cl"><span class="err">00000016</span>  <span class="nf">invoke-virtual</span>      <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">Exception1</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catch</span> <span class="no">ArrayIndexOutOfBoundsException</span> <span class="err">{</span><span class="p">:</span><span class="no">try_16</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_1C</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_46</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catch</span> <span class="no">Exception</span> <span class="err">{</span><span class="p">:</span><span class="no">try_16</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_1C</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_32</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catchall</span> <span class="err">{</span><span class="p">:</span><span class="no">try_16</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_1C</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_1E</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">tryend_1C</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">C</span>  <span class="no">goto</span>                <span class="p">:</span><span class="mi">58</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_1E</span>  <span class="c1"># used for: *
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">0000001</span><span class="nf">E</span>  <span class="no">move-exception</span>      <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000020</span>  <span class="nf">const-string</span>        <span class="no">v1</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">Throwable</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">00000024</span>  <span class="nf">invoke-static</span>       <span class="no">Log-</span><span class="err">&gt;</span><span class="no">d</span><span class="p">(</span><span class="no">String</span><span class="p">,</span> <span class="no">String</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000002</span><span class="nf">A</span>  <span class="no">invoke-virtual</span>      <span class="no">Throwable-</span><span class="err">&gt;</span><span class="no">printStackTrace</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000030</span>  <span class="nf">goto</span>                <span class="p">:</span><span class="mi">58</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_32</span>  <span class="c1"># used for: Ljava/lang/Exception;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000032</span>  <span class="nf">move-exception</span>      <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000034</span>  <span class="nf">const-string</span>        <span class="no">v1</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">Exception</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">00000038</span>  <span class="nf">invoke-static</span>       <span class="no">Log-</span><span class="err">&gt;</span><span class="no">d</span><span class="p">(</span><span class="no">String</span><span class="p">,</span> <span class="no">String</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000003</span><span class="nf">E</span>  <span class="no">invoke-virtual</span>      <span class="no">Exception-</span><span class="err">&gt;</span><span class="no">printStackTrace</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000044</span>  <span class="nf">goto</span>                <span class="p">:</span><span class="mi">58</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_46</span>  <span class="c1"># used for: Ljava/lang/ArrayIndexOutOfBoundsException;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000046</span>  <span class="nf">move-exception</span>      <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000048</span>  <span class="nf">const-string</span>        <span class="no">v1</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">ArrayIndexOutOfBoundsException</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">0000004</span><span class="nf">C</span>  <span class="no">invoke-static</span>       <span class="no">Log-</span><span class="err">&gt;</span><span class="no">d</span><span class="p">(</span><span class="no">String</span><span class="p">,</span> <span class="no">String</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">v0</span><span class="p">,</span> <span class="no">v1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000052</span>  <span class="nf">invoke-virtual</span>      <span class="no">ArrayIndexOutOfBoundsException-</span><span class="err">&gt;</span><span class="no">printStackTrace</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">:58</span>
</span></span><span class="line"><span class="cl"><span class="err">00000058</span>  <span class="nf">return-void</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.catch</span> <span class="no">ArrayIndexOutOfBoundsException</span> <span class="err">{</span><span class="p">:</span><span class="no">try_16</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_1C</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_46</span>  <span class="c1">#这个地方是说标号try_16-tryend_1C之间会抛异常,catch代码在标号catch_46处,下面的同理.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="na">.catch</span> <span class="no">Exception</span> <span class="err">{</span><span class="p">:</span><span class="no">try_16</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_1C</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_32</span>
</span></span><span class="line"><span class="cl"><span class="na">.catchall</span> <span class="err">{</span><span class="p">:</span><span class="no">try_16</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_1C</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_1E</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>示例 try-catch-finally</strong>:</p>
<p>Java:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Exception1</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayIndexOutOfBoundsException</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Exception1</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ArrayIndexOutOfBoundsException</span><span class="w"> </span><span class="n">e</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&#34;Luo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;ArrayIndexOutOfBoundsException&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&#34;Luo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Exception&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">throwable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&#34;Luo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Throwable&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">throwable</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&#34;Luo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;finally&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Smali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="na">.method</span> <span class="no">protected</span> <span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span>
</span></span><span class="line"><span class="cl">          <span class="na">.registers</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="err">00000000</span>  <span class="nf">const-string</span>        <span class="no">v0</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">finally</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">00000004</span>  <span class="nf">const-string</span>        <span class="no">v1</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">Luo</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">00000008</span>  <span class="nf">invoke-super</span>        <span class="no">AppCompatActivity-</span><span class="err">&gt;</span><span class="no">onCreate</span><span class="p">(</span><span class="no">Bundle</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000000</span><span class="nf">E</span>  <span class="no">const</span>               <span class="no">p1</span><span class="p">,</span> <span class="mi">0x7F0B001C</span>        <span class="c1"># layout:activity_main
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000014</span>  <span class="nf">invoke-virtual</span>      <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">setContentView</span><span class="p">(</span><span class="no">I</span><span class="p">)</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">try_1A</span>
</span></span><span class="line"><span class="cl"><span class="err">0000001</span><span class="nf">A</span>  <span class="no">invoke-virtual</span>      <span class="no">MainActivity-</span><span class="err">&gt;</span><span class="no">Exception1</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">p0</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catch</span> <span class="no">ArrayIndexOutOfBoundsException</span> <span class="err">{</span><span class="p">:</span><span class="no">try_1A</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_20</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_50</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catch</span> <span class="no">Exception</span> <span class="err">{</span><span class="p">:</span><span class="no">try_1A</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_20</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_3C</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catchall</span> <span class="err">{</span><span class="p">:</span><span class="no">try_1A</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_20</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_28</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">tryend_20</span>
</span></span><span class="line"><span class="cl"><span class="err">00000020</span>  <span class="nf">invoke-static</span>       <span class="no">Log-</span><span class="err">&gt;</span><span class="no">d</span><span class="p">(</span><span class="no">String</span><span class="p">,</span> <span class="no">String</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">00000026</span>  <span class="nf">goto</span>                <span class="p">:</span><span class="mi">64</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_28</span>  <span class="c1"># used for: *
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000028</span>  <span class="nf">move-exception</span>      <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">try_2A</span>
</span></span><span class="line"><span class="cl"><span class="err">0000002</span><span class="nf">A</span>  <span class="no">const-string</span>        <span class="no">v2</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">Throwable</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">0000002</span><span class="nf">E</span>  <span class="no">invoke-static</span>       <span class="no">Log-</span><span class="err">&gt;</span><span class="no">d</span><span class="p">(</span><span class="no">String</span><span class="p">,</span> <span class="no">String</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000034</span>  <span class="nf">invoke-virtual</span>      <span class="no">Throwable-</span><span class="err">&gt;</span><span class="no">printStackTrace</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000003</span><span class="nf">A</span>  <span class="no">goto</span>                <span class="p">:</span><span class="no">tryend_20</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_3C</span>  <span class="c1"># used for: Ljava/lang/Exception;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">0000003</span><span class="nf">C</span>  <span class="no">move-exception</span>      <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000003</span><span class="nf">E</span>  <span class="no">const-string</span>        <span class="no">v2</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">Exception</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">00000042</span>  <span class="nf">invoke-static</span>       <span class="no">Log-</span><span class="err">&gt;</span><span class="no">d</span><span class="p">(</span><span class="no">String</span><span class="p">,</span> <span class="no">String</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="err">00000048</span>  <span class="nf">invoke-virtual</span>      <span class="no">Exception-</span><span class="err">&gt;</span><span class="no">printStackTrace</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">0000004</span><span class="nf">E</span>  <span class="no">goto</span>                <span class="p">:</span><span class="no">tryend_20</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_50</span>  <span class="c1"># used for: Ljava/lang/ArrayIndexOutOfBoundsException;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000050</span>  <span class="nf">move-exception</span>      <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000052</span>  <span class="nf">const-string</span>        <span class="no">v2</span><span class="p">,</span> <span class="err">&#34;</span><span class="no">ArrayIndexOutOfBoundsException</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">00000056</span>  <span class="nf">invoke-static</span>       <span class="no">Log-</span><span class="err">&gt;</span><span class="no">d</span><span class="p">(</span><span class="no">String</span><span class="p">,</span> <span class="no">String</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="no">v2</span>
</span></span><span class="line"><span class="cl"><span class="err">0000005</span><span class="nf">C</span>  <span class="no">invoke-virtual</span>      <span class="no">ArrayIndexOutOfBoundsException-</span><span class="err">&gt;</span><span class="no">printStackTrace</span><span class="p">()</span><span class="no">V</span><span class="p">,</span> <span class="no">p1</span>
</span></span><span class="line"><span class="cl">          <span class="na">.catchall</span> <span class="err">{</span><span class="p">:</span><span class="no">try_2A</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_62</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_66</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">tryend_62</span>
</span></span><span class="line"><span class="cl"><span class="err">00000062</span>  <span class="nf">goto</span>                <span class="p">:</span><span class="no">tryend_20</span>
</span></span><span class="line"><span class="cl"><span class="err">:64</span>
</span></span><span class="line"><span class="cl"><span class="err">00000064</span>  <span class="nf">return-void</span>
</span></span><span class="line"><span class="cl"><span class="err">:</span><span class="nf">catch_66</span>  <span class="c1"># used for: *
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000066</span>  <span class="nf">move-exception</span>      <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="err">00000068</span>  <span class="nf">invoke-static</span>       <span class="no">Log-</span><span class="err">&gt;</span><span class="no">d</span><span class="p">(</span><span class="no">String</span><span class="p">,</span> <span class="no">String</span><span class="p">)</span><span class="no">I</span><span class="p">,</span> <span class="no">v1</span><span class="p">,</span> <span class="no">v0</span>
</span></span><span class="line"><span class="cl"><span class="err">0000006</span><span class="nf">E</span>  <span class="no">throw</span>               <span class="no">p1</span>
</span></span><span class="line"><span class="cl"><span class="na">.end</span> <span class="no">method</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">/*首先需要明确的是</span><span class="nf">finally的代码</span><span class="p">,</span><span class="err">不管有木有抛异常或者</span><span class="no">catch中的代码崩了</span><span class="p">,</span><span class="err">都会走</span><span class="no">finally的代码.</span>
</span></span><span class="line"><span class="cl"><span class="err">编译器将</span><span class="nf">finally的代码提出来放在每个catch中</span><span class="p">,</span><span class="err">所以还原的时候</span><span class="p">,</span><span class="err">将每个</span><span class="no">catch中重复的代码提出来</span><span class="p">,</span><span class="err">就是</span><span class="no">finally的代码</span><span class="p">*</span>
</span></span><span class="line"><span class="cl"><span class="na">.catch</span> <span class="no">ArrayIndexOutOfBoundsException</span> <span class="err">{</span><span class="p">:</span><span class="no">try_1A</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_20</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_50</span>
</span></span><span class="line"><span class="cl"><span class="na">.catch</span> <span class="no">Exception</span> <span class="err">{</span><span class="p">:</span><span class="no">try_1A</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_20</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_3C</span>
</span></span><span class="line"><span class="cl"><span class="na">.catchall</span> <span class="err">{</span><span class="p">:</span><span class="no">try_1A</span> <span class="no">..</span> <span class="p">:</span><span class="no">tryend_20</span><span class="err">}</span> <span class="p">:</span><span class="no">catch_28</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="smali调试" class="heading-element"><span>Smali调试</span>
  <a href="#smali%e8%b0%83%e8%af%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="jdbexe" class="heading-element"><span>jdb.exe</span>
  <a href="#jdbexe" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>jdwp协议:</p>
<p>是Java Debug Wire Protocol的缩写,定义了调试器(debugger)和被调试的Java虚拟机(target vm)之间的通信协议.</p>
<p>使用jdwp协议来双机调试Android程序,调试之前需要端口映射,但很多工具已提前做好了端口映射.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">adb forward tcp:8700 jdwp:PID</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/jdwp%E5%8D%8F%E8%AE%AE.png" alt="jdwp协议" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/jdwp%E5%8D%8F%E8%AE%AE.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/jdwp%E5%8D%8F%E8%AE%AE.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/jdwp%E5%8D%8F%E8%AE%AE.png?size=large 2x" data-title="jdwp协议" style="--width: 1680px;--aspect-ratio: 1680 / 973;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>jdb所在目录:</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/jdb%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95.png" alt="jdb所在目录" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/jdb%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/jdb%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/jdb%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95.png?size=large 2x" data-title="jdb所在目录" style="--width: 1355px;--aspect-ratio: 1355 / 922;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>输入jdb &ndash;help可查看帮助.</p>
<p>jdb可以用来调Android程序,Android上调试端口一般为8700,但是单步很麻烦,很多工具已集成该功能.</p>
<h4 id="android调试运行" class="heading-element"><span>Android调试运行</span>
  <a href="#android%e8%b0%83%e8%af%95%e8%bf%90%e8%a1%8c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>AndroidMenifest文件说明Debug</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">android:debuggable=&#34;true&#34;</span></span></code></pre></td></tr></table>
</div>
</div><p>虚拟机加不加这个都可以调试.</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AndroidMenifest%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8EDebug.png" alt="AndroidMenifest文件说明Debug" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AndroidMenifest%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8EDebug.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AndroidMenifest%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8EDebug.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AndroidMenifest%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8EDebug.png?size=large 2x" data-title="AndroidMenifest文件说明Debug" style="--width: 1152px;--aspect-ratio: 1152 / 613;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="2">
<li>使用am调试运行</li>
</ol>
<p>位于Android系统,system/bin目录.</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E4%BD%8D%E4%BA%8EAndroid%E7%B3%BB%E7%BB%9F,%E7%9B%AE%E5%BD%95.png" alt="位于Android系统,目录" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E4%BD%8D%E4%BA%8EAndroid%E7%B3%BB%E7%BB%9F%2c%E7%9B%AE%E5%BD%95.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E4%BD%8D%E4%BA%8EAndroid%E7%B3%BB%E7%BB%9F%2c%E7%9B%AE%E5%BD%95.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E4%BD%8D%E4%BA%8EAndroid%E7%B3%BB%E7%BB%9F%2c%E7%9B%AE%E5%BD%95.png?size=large 2x" data-title="位于Android系统,目录" style="--width: 812px;--aspect-ratio: 812 / 1340;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="3">
<li>查看帮助</li>
</ol>
<p>命令行输入 adb shell进shell</p>
<p>然后输入am,即可查看帮助.</p>
<ol start="4">
<li>调试运行一个Activity</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">am start -D -N org.example.luotest/.MainActivity</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E8%B0%83%E8%AF%95%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AAActivity.png" alt="调试运行一个Activity" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E8%B0%83%E8%AF%95%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AAActivity.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E8%B0%83%E8%AF%95%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AAActivity.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E8%B0%83%E8%AF%95%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AAActivity.png?size=large 2x" data-title="调试运行一个Activity" style="--width: 1790px;--aspect-ratio: 1790 / 783;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h4 id="jeb" class="heading-element"><span>Jeb</span>
  <a href="#jeb" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>被调试程序源代码:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MainActivity</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AppCompatActivity</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_main</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Button</span><span class="w"> </span><span class="n">button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">button</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">button</span><span class="p">.</span><span class="na">setOnClickListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">View</span><span class="p">.</span><span class="na">OnClickListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onClick</span><span class="p">(</span><span class="n">View</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">3</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&#34;Luo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;onClick: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>附加调试:</p>
<p>切记调试的时候,关闭AndroidStudio,AS会占用8700端口.</p>
<ol>
<li>在虚拟机中运行该程序.</li>
<li>用Jeb打开该apk,找到按钮相应函数,下断(Ctrl + B)</li>
</ol>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%952.png" alt="Jeb附加调试2" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%952.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%952.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%952.png?size=large 2x" data-title="Jeb附加调试2" style="--width: 1240px;--aspect-ratio: 1240 / 591;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="3">
<li>Jeb菜单,调试器开始.</li>
</ol>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%953.png" alt="Jeb附加调试3" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%953.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%953.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%953.png?size=large 2x" data-title="Jeb附加调试3" style="--width: 1231px;--aspect-ratio: 1231 / 206;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="4">
<li>点附上,Jeb就会附加.</li>
</ol>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%954.png" alt="Jeb附加调试4" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%954.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%954.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%954.png?size=large 2x" data-title="Jeb附加调试4" style="--width: 876px;--aspect-ratio: 876 / 732;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="5">
<li>在虚拟机中,点击程序的按钮,就会在刚开始下断的地方断下.</li>
</ol>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%955.png" alt="Jeb附加调试5" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%955.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%955.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/Jeb%E9%99%84%E5%8A%A0%E8%B0%83%E8%AF%955.png?size=large 2x" data-title="Jeb附加调试5" style="--width: 2092px;--aspect-ratio: 2092 / 1045;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h4 id="androidstudio" class="heading-element"><span>AndroidStudio</span>
  <a href="#androidstudio" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>下载Smali反汇编插件 smalidea.</li>
</ol>
<p><a href="https://bitbucket.org/JesusFreke/smalidea/downloads/"target="_blank" rel="external nofollow noopener noreferrer">https://bitbucket.org/JesusFreke/smalidea/downloads/</a></p>
<ol start="2">
<li>安装插件.</li>
</ol>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B62_1.png" alt="AS安装插件2_1" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B62_1.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B62_1.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B62_1.png?size=large 2x" data-title="AS安装插件2_1" style="--width: 1845px;--aspect-ratio: 1845 / 936;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B62_2.png" alt="AS安装插件2_2" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B62_2.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B62_2.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B62_2.png?size=large 2x" data-title="AS安装插件2_2" style="--width: 794px;--aspect-ratio: 794 / 959;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="3">
<li>使用apktool反编译apk.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">java</span> <span class="o">-</span><span class="n">jar</span> <span class="n">apktool</span><span class="o">.</span><span class="n">jar</span> <span class="n">d</span> <span class="o">-</span><span class="n">f</span> <span class="n">app</span><span class="o">-</span><span class="n">debug</span><span class="o">.</span><span class="n">apk</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%953.png" alt="AS调试3" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%953.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%953.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%953.png?size=large 2x" data-title="AS调试3" style="--width: 1587px;--aspect-ratio: 1587 / 765;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="4">
<li>使用AS导入刚反编译出来的文件</li>
</ol>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_1.png" alt="AS调试4_1" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_1.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_1.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_1.png?size=large 2x" data-title="AS调试4_1" style="--width: 1991px;--aspect-ratio: 1991 / 331;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_2.png" alt="AS调试4_2" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_2.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_2.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_2.png?size=large 2x" data-title="AS调试4_2" style="--width: 1337px;--aspect-ratio: 1337 / 904;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_3.png" alt="AS调试4_3" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_3.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_3.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%954_3.png?size=large 2x" data-title="AS调试4_3" style="--width: 1395px;--aspect-ratio: 1395 / 1088;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="5">
<li>调试运行一个Activity</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="c1">//adb shell am start -D -n packageName/ActivityName(这两个参数在AndroidMainfest.xml里都可以找到)
</span></span></span><span class="line"><span class="cl"><span class="c1">//分别对应package=xxx activity中android:name=xxx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">adb</span> <span class="n">shell</span> <span class="n">am</span> <span class="n">start</span> <span class="o">-</span><span class="n">D</span> <span class="o">-</span><span class="n">N</span> <span class="n">org</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">luotest</span><span class="o">/</span><span class="p">.</span><span class="n">MainActivity</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%955.png" alt="AS调试5" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%955.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%955.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%955.png?size=large 2x" data-title="AS调试5" style="--width: 1913px;--aspect-ratio: 1913 / 806;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="6">
<li>端口映射</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">adb forward tcp:8700 jdwp:2745</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%956.png" alt="AS调试6" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%956.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%956.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%956.png?size=large 2x" data-title="AS调试6" style="--width: 1330px;--aspect-ratio: 1330 / 858;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ol start="7">
<li>AS下断,远程附加</li>
</ol>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_1.png" alt="AS调试7_1" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_1.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_1.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_1.png?size=large 2x" data-title="AS调试7_1" style="--width: 2151px;--aspect-ratio: 2151 / 430;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_2.png" alt="AS调试7_2" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_2.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_2.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_2.png?size=large 2x" data-title="AS调试7_2" style="--width: 355px;--aspect-ratio: 355 / 210;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_3.png" alt="AS调试7_3" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_3.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_3.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_3.png?size=large 2x" data-title="AS调试7_3" style="--width: 456px;--aspect-ratio: 456 / 879;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_4.png" alt="AS调试7_4" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_4.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_4.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%957_4.png?size=large 2x" data-title="AS调试7_4" style="--width: 1737px;--aspect-ratio: 1737 / 1054;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>点击Debug按钮进行调试,就可以调试了.</p>
<p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%958.png" alt="AS调试8" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%958.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%958.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/AS%E8%B0%83%E8%AF%958.png?size=large 2x" data-title="AS调试8" style="--width: 2104px;--aspect-ratio: 2104 / 1392;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h4 id="反调试" class="heading-element"><span>反调试</span>
  <a href="#%e5%8f%8d%e8%b0%83%e8%af%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><h5 id="检测调试标志" class="heading-element"><span>检测调试标志</span>
  <a href="#%e6%a3%80%e6%b5%8b%e8%b0%83%e8%af%95%e6%a0%87%e5%bf%97" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%A3%80%E6%B5%8B%E8%B0%83%E8%AF%95%E6%A0%87%E5%BF%97.png" alt="检测调试标志" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%A3%80%E6%B5%8B%E8%B0%83%E8%AF%95%E6%A0%87%E5%BF%97.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%A3%80%E6%B5%8B%E8%B0%83%E8%AF%95%E6%A0%87%E5%BF%97.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E6%A3%80%E6%B5%8B%E8%B0%83%E8%AF%95%E6%A0%87%E5%BF%97.png?size=large 2x" data-title="检测调试标志" style="--width: 1267px;--aspect-ratio: 1267 / 810;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>对策:给open这个api下断,发现他读的TracePid,就返回0.</p>
<h5 id="时间差" class="heading-element"><span>时间差</span>
  <a href="#%e6%97%b6%e9%97%b4%e5%b7%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p>不通过api拿时间,防止别人通过下时间断点来修改时间.</p>
<h5 id="检测ida端口号23946" class="heading-element"><span>检测IDA端口号23946</span>
  <a href="#%e6%a3%80%e6%b5%8bida%e7%ab%af%e5%8f%a3%e5%8f%b723946" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><strong>修改IDA端口号</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/data/local/tmp/android_server -i 127.0.0.1 -p 8899</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E4%BF%AE%E6%94%B9IDA%E7%AB%AF%E5%8F%A3%E5%8F%B7.png" alt="修改IDA端口号" srcset="/posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E4%BF%AE%E6%94%B9IDA%E7%AB%AF%E5%8F%A3%E5%8F%B7.png?size=small, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E4%BF%AE%E6%94%B9IDA%E7%AB%AF%E5%8F%A3%E5%8F%B7.png?size=medium 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/smali/images/Smali/%E4%BF%AE%E6%94%B9IDA%E7%AB%AF%E5%8F%A3%E5%8F%B7.png?size=large 2x" data-title="修改IDA端口号" style="--width: 1381px;--aspect-ratio: 1381 / 631;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2021-09-05 00:00:00">更新于 2021-09-05&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/smali/" class="post-tag" title="标签 - Smali">Smali</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/%E5%B9%B3%E5%8F%B0api/github/" class="post-nav-item" rel="prev" title="Github Api调用"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Github Api调用</a>
      <a href="/posts/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/cobaltstrike/" class="post-nav-item" rel="next" title="CobaltStrike使用">CobaltStrike使用<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2020 - 2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/">夏洛魂</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">该网站在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":150},"comment":{"enable":false},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"version":"v0.3.8-RC"};</script><script src="/js/theme.min.js" defer></script><script src="/js/custom.min.js" defer></script></body>
</html>
