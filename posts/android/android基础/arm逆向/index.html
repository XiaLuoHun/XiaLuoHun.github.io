<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Arm逆向 - 夏洛魂的个人博客</title><meta name="Description" content="个人笔记本"><meta property="og:title" content="Arm逆向" />
<meta property="og:description" content="Arm逆向 这部分内容跟x86很大程度上都是一样的. 加法 源代码 1 2 3 4 5 6 7 8 9 10 int main(int argc, char** argv){ 15 &#43; 20; int n1 = 0; int n2 = 0; n1 = n1 &#43; 1; n1 = 1 &#43; 2; n1 = n1 &#43;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://XiaLuoHun.github.io/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-09-12T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Arm逆向"/>
<meta name="twitter:description" content="Arm逆向 这部分内容跟x86很大程度上都是一样的. 加法 源代码 1 2 3 4 5 6 7 8 9 10 int main(int argc, char** argv){ 15 &#43; 20; int n1 = 0; int n2 = 0; n1 = n1 &#43; 1; n1 = 1 &#43; 2; n1 = n1 &#43;"/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="canonical" href="https://XiaLuoHun.github.io/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/" /><link rel="prev" href="https://XiaLuoHun.github.io/posts/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/cobaltstrike/" /><link rel="next" href="https://XiaLuoHun.github.io/posts/android/android%E5%9F%BA%E7%A1%80/dex/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Arm逆向",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/XiaLuoHun.github.io\/posts\/android\/android%E5%9F%BA%E7%A1%80\/arm%E9%80%86%E5%90%91\/"
        },"genre": "posts","keywords": "Arm","wordcount":  8848 ,
        "url": "https:\/\/XiaLuoHun.github.io\/posts\/android\/android%E5%9F%BA%E7%A1%80\/arm%E9%80%86%E5%90%91\/","datePublished": "2021-09-12T00:00:00+00:00","dateModified": "2021-09-12T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "夏洛魂"},"author": {
                "@type": "Person",
                "name": "夏洛魂"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="夏洛魂的个人博客">主页</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/excalidraw/"> 在线绘图 </a><a class="menu-item" href="/about/"> 关于作者 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="夏洛魂的个人博客">主页</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/excalidraw/" title="">在线绘图</a><a class="menu-item" href="/about/" title="">关于作者</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Arm逆向</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>夏洛魂</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/android%E5%9F%BA%E7%A1%80/"><i class="far fa-folder fa-fw"></i>Android基础</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-09-12">2021-09-12</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 8848 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 18 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#arm逆向">Arm逆向</a>
          <ul>
            <li><a href="#加法">加法</a>
              <ul>
                <li><a href="#源代码">源代码</a></li>
                <li><a href="#arm-v7a">arm-v7a</a></li>
                <li><a href="#arm-v8a">arm-v8a</a></li>
              </ul>
            </li>
            <li><a href="#减法">减法</a>
              <ul>
                <li><a href="#源代码-1">源代码</a></li>
                <li><a href="#arm-v7a-1">arm-v7a</a></li>
              </ul>
            </li>
            <li><a href="#乘法">乘法</a>
              <ul>
                <li><a href="#源代码-2">源代码</a></li>
                <li><a href="#arm-v7a-2">arm-v7a</a></li>
              </ul>
            </li>
            <li><a href="#除法">除法</a>
              <ul>
                <li><a href="#无符号">无符号</a>
                  <ul>
                    <li><a href="#除数为2的幂常量">除数为2的幂(常量)</a>
                      <ul>
                        <li><a href="#源代码-3">源代码</a></li>
                        <li><a href="#arm-v7a-3">arm-v7a</a></li>
                        <li><a href="#arm-v8a-1">arm-v8a</a></li>
                        <li><a href="#总结">总结</a></li>
                      </ul>
                    </li>
                    <li><a href="#除数为非2的幂常量">除数为非2的幂(常量)</a>
                      <ul>
                        <li><a href="#magicnumber无进位">MagicNumber无进位</a></li>
                        <li><a href="#magicnumber有进位">MagicNumber有进位</a></li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li><a href="#有符号">有符号</a>
                  <ul>
                    <li><a href="#除数为正2的幂">除数为正2的幂</a>
                      <ul>
                        <li><a href="#源代码-4">源代码</a></li>
                        <li><a href="#arm-v7a-4">arm-v7a</a></li>
                        <li><a href="#arm-v8a-2">arm-v8a</a></li>
                        <li><a href="#总结-1">总结</a></li>
                      </ul>
                    </li>
                    <li><a href="#除数为正非2的幂">除数为正非2的幂</a>
                      <ul>
                        <li><a href="#magicnumber为正">MagicNumber为正</a></li>
                        <li><a href="#magicnumber为负">MagicNumber为负</a></li>
                      </ul>
                    </li>
                    <li><a href="#除数为负2的幂">除数为负2的幂</a>
                      <ul>
                        <li><a href="#源代码-5">源代码</a></li>
                        <li><a href="#arm-v7a-5">arm-v7a</a></li>
                        <li><a href="#arm-v8a-3">arm-v8a</a></li>
                        <li><a href="#总结-2">总结</a></li>
                      </ul>
                    </li>
                    <li><a href="#除数为负非2的幂">除数为负非2的幂</a>
                      <ul>
                        <li><a href="#magicnumber为正-1">MagicNumber为正</a></li>
                        <li><a href="#magicnumber为负-1">MagicNumber为负</a></li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#取模">取模</a>
              <ul>
                <li><a href="#无符号-1">无符号</a>
                  <ul>
                    <li><a href="#除数为2的幂">除数为2的幂</a>
                      <ul>
                        <li><a href="#源代码-6">源代码</a></li>
                        <li><a href="#arm-v7a-6">arm-v7a</a></li>
                        <li><a href="#总结-3">总结</a></li>
                      </ul>
                    </li>
                    <li><a href="#除数为非2的幂">除数为非2的幂</a>
                      <ul>
                        <li><a href="#源代码-7">源代码</a></li>
                        <li><a href="#arm-v7a-7">arm-v7a</a></li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li><a href="#有符号-1">有符号</a>
                  <ul>
                    <li><a href="#除数为2的幂-1">除数为2的幂</a>
                      <ul>
                        <li><a href="#源代码-8">源代码</a></li>
                        <li><a href="#arm-v7a-8">arm-v7a</a></li>
                        <li><a href="#总结-4">总结</a></li>
                      </ul>
                    </li>
                    <li><a href="#除数为非2的幂-1">除数为非2的幂</a>
                      <ul>
                        <li><a href="#源代码-9">源代码</a></li>
                        <li><a href="#arm-v7a-9">arm-v7a</a></li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#分支">分支</a>
              <ul>
                <li><a href="#if">if</a>
                  <ul>
                    <li><a href="#源代码-10">源代码</a></li>
                    <li><a href="#arm-v7a-10">arm-v7a</a></li>
                  </ul>
                </li>
                <li><a href="#while">while</a>
                  <ul>
                    <li><a href="#源代码-11">源代码</a></li>
                    <li><a href="#arm-v7a-11">arm-v7a</a></li>
                  </ul>
                </li>
                <li><a href="#do-while">do-while</a>
                  <ul>
                    <li><a href="#源代码-12">源代码</a></li>
                    <li><a href="#arm-v7a-12">arm-v7a</a></li>
                  </ul>
                </li>
                <li><a href="#switch-case">Switch-case</a>
                  <ul>
                    <li><a href="#源代码-13">源代码</a></li>
                    <li><a href="#arm-v7a-13">arm-v7a</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#函数">函数</a>
              <ul>
                <li><a href="#整型传参">整型传参</a>
                  <ul>
                    <li><a href="#源代码-14">源代码</a></li>
                    <li><a href="#arm-v7a-14">arm-v7a</a></li>
                    <li><a href="#arm-v8a-4">arm-v8a</a></li>
                  </ul>
                </li>
                <li><a href="#浮点传参">浮点传参</a>
                  <ul>
                    <li><a href="#源代码-15">源代码</a></li>
                    <li><a href="#arm-v7a-15">arm-v7a</a></li>
                    <li><a href="#arm-v8a-5">arm-v8a</a></li>
                  </ul>
                </li>
                <li><a href="#混合传参">混合传参</a>
                  <ul>
                    <li><a href="#源代码-16">源代码</a></li>
                    <li><a href="#arm-v7a-16">arm-v7a</a></li>
                    <li><a href="#arm-v8a-6">arm-v8a</a></li>
                  </ul>
                </li>
                <li><a href="#注意的小细节">注意的小细节</a>
                  <ul>
                    <li><a href="#源代码-17">源代码</a></li>
                    <li><a href="#arm-v7a-17">arm-v7a</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#变量">变量</a>
              <ul>
                <li><a href="#全局变量">全局变量</a>
                  <ul>
                    <li><a href="#源代码-18">源代码</a></li>
                    <li><a href="#总结-5">总结</a></li>
                  </ul>
                </li>
                <li><a href="#静态局部变量">静态局部变量</a>
                  <ul>
                    <li><a href="#源代码-19">源代码</a></li>
                    <li><a href="#总结-6">总结</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#数组">数组</a>
              <ul>
                <li><a href="#一维数组">一维数组</a>
                  <ul>
                    <li><a href="#源代码-20">源代码</a></li>
                    <li><a href="#总结-7">总结</a></li>
                  </ul>
                </li>
                <li><a href="#二维数组">二维数组</a>
                  <ul>
                    <li><a href="#源代码-21">源代码</a></li>
                    <li><a href="#总结-8">总结</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#类">类</a>
              <ul>
                <li><a href="#this指针">this指针</a>
                  <ul>
                    <li><a href="#源代码-22">源代码</a></li>
                    <li><a href="#总结-9">总结</a></li>
                  </ul>
                </li>
                <li><a href="#对象作为参数">对象作为参数</a>
                  <ul>
                    <li><a href="#源代码-23">源代码</a></li>
                    <li><a href="#总结-10">总结</a></li>
                  </ul>
                </li>
                <li><a href="#返回对象">返回对象</a>
                  <ul>
                    <li><a href="#源代码-24">源代码</a></li>
                    <li><a href="#总结-11">总结</a></li>
                  </ul>
                </li>
                <li><a href="#构造函数">构造函数</a>
                  <ul>
                    <li><a href="#源代码-25">源代码</a></li>
                    <li><a href="#总结-12">总结</a></li>
                  </ul>
                </li>
                <li><a href="#虚析构">虚析构</a>
                  <ul>
                    <li><a href="#源代码-26">源代码</a></li>
                    <li><a href="#总结-13">总结</a></li>
                  </ul>
                </li>
                <li><a href="#单重继承">单重继承</a>
                  <ul>
                    <li><a href="#源代码-27">源代码</a></li>
                    <li><a href="#总结-14">总结</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="arm逆向">Arm逆向</h2>
<p>这部分内容跟x86很大程度上都是一样的.</p>
<h3 id="加法">加法</h3>
<h4 id="源代码">源代码</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="mi">15</span> <span class="o">+</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">n1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="arm-v7a">arm-v7a</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">LDR</span>             <span class="no">argc</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aN1D</span> <span class="p">-</span> <span class="mi">0x2A0C</span><span class="p">)</span> <span class="c1">; &#34;n1 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A06</span>                 <span class="no">MOVS</span>            <span class="no">argv</span><span class="p">,</span> <span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;n1 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="arm-v8a">arm-v8a</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">LDR</span>             <span class="no">argc</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aN1D</span> <span class="p">-</span> <span class="mi">0x2A0C</span><span class="p">)</span> <span class="c1">; &#34;n1 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A06</span>                 <span class="no">MOVS</span>            <span class="no">argv</span><span class="p">,</span> <span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;n1 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="减法">减法</h3>
<h4 id="源代码-1">源代码</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">argc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">-</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="arm-v7a-1">arm-v7a</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029EC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span> <span class="no">var_10</span>          <span class="err">=</span> <span class="p">-</span><span class="mi">0x10</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span> <span class="no">var_C</span>           <span class="err">=</span> <span class="p">-</span><span class="mi">0xC</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A30</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R4</span><span class="p">,</span><span class="no">R5</span><span class="p">,</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A32</span>                 <span class="no">ADD</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span><span class="p">,</span> <span class="c1">#8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A34</span>                 <span class="no">SUB</span>             <span class="no">SP</span><span class="p">,</span> <span class="no">SP</span><span class="p">,</span> <span class="c1">#8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A36</span>                 <span class="no">MOV</span>             <span class="no">R4</span><span class="p">,</span> <span class="no">argc</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A38</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R4</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A38</span>                 <span class="no">LDR</span>             <span class="no">R0</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">__stack_chk_guard_ptr</span> <span class="p">-</span> <span class="mi">0x2A3E</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A3A</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; __stack_chk_guard_ptr
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A3C</span>                 <span class="no">LDR</span>             <span class="no">R5</span><span class="p">,</span> <span class="p">[</span><span class="no">R0</span><span class="p">]</span> <span class="c1">; __stack_chk_guard
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A3E</span>                 <span class="no">LDR</span>             <span class="no">argv</span><span class="p">,</span> <span class="p">[</span><span class="no">R5</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A40</span>                 <span class="no">LDR</span>             <span class="no">R0</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aD</span> <span class="p">-</span> <span class="mi">0x2A4A</span><span class="p">)</span> <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A42</span>                 <span class="no">STR</span>             <span class="no">R1</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#0x10+var_C]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A44</span> <span class="no">n1</span> <span class="err">=</span> <span class="no">R4</span>                                 <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A44</span>                 <span class="no">MOVS</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A46</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;%d&#34; ; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A48</span>                 <span class="no">STR</span>             <span class="no">R1</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#0x10+var_10]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A4A</span>                 <span class="no">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A4C</span>                 <span class="no">BLX</span>             <span class="no">scanf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A50</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R4</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A50</span>                 <span class="no">LDR</span>             <span class="no">R1</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#0x10+var_10]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A52</span> <span class="no">n2</span> <span class="err">=</span> <span class="no">R1</span>                                 <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A52</span>                 <span class="no">LDR</span>             <span class="no">R0</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aN1D</span> <span class="p">-</span> <span class="mi">0x2A5A</span><span class="p">)</span> <span class="c1">; &#34;n1 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A54</span>                 <span class="no">SUBS</span>            <span class="no">n2</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">n2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A56</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;n1 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A58</span>                 <span class="no">SUBS</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x5F ; &#39;_&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A5A</span> <span class="no">n1</span> <span class="err">=</span> <span class="no">R1</span>                                 <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A5A</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A5E</span>                 <span class="no">LDR</span>             <span class="no">R0</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#0x10+var_C]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A60</span>                 <span class="no">LDR</span>             <span class="no">R1</span><span class="p">,</span> <span class="p">[</span><span class="no">R5</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A62</span>                 <span class="no">SUBS</span>            <span class="no">R0</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">R0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A64</span>                 <span class="no">ITTT</span> <span class="no">EQ</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A66</span>                 <span class="no">MOVEQ</span>           <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A68</span>                 <span class="no">ADDEQ</span>           <span class="no">SP</span><span class="p">,</span> <span class="no">SP</span><span class="p">,</span> <span class="c1">#8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A6A</span>                 <span class="no">POPEQ</span>           <span class="err">{</span><span class="no">argc</span><span class="p">,</span><span class="no">R5</span><span class="p">,</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A6C</span>                 <span class="no">BLX</span>             <span class="no">__stack_chk_fail</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A6C</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上述中的ITTT EQ指令中有3个T,表示接下来的3条指令是条件执行指令.
IT EQ,这是thumb2的指令,是指令前缀.</p>
<h3 id="乘法">乘法</h3>
<h4 id="源代码-2">源代码</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">argc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">argc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 * 15 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span> <span class="o">*</span><span class="mi">15</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="arm-v7a-2">arm-v7a</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span> <span class="no">n2</span> <span class="err">=</span> <span class="no">R0</span>                                 <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aN115D</span> <span class="p">-</span> <span class="mi">0x2A0E</span><span class="p">)</span> <span class="c1">; &#34;n1 * 15 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A06</span>                 <span class="no">RSB.W</span>           <span class="no">argv</span><span class="p">,</span> <span class="no">n2</span><span class="p">,</span> <span class="no">n2</span><span class="p">,</span><span class="no">LSL</span><span class="c1">#4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;n1 * 15 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">MOV</span>             <span class="no">n2</span><span class="p">,</span> <span class="no">R2</span>  <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="除法">除法</h3>
<h4 id="无符号">无符号</h4>
<h5 id="除数为2的幂常量">除数为2的幂(常量)</h5>
<h6 id="源代码-3">源代码</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / 8&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">argc</span> <span class="o">/</span> <span class="mi">8</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v7a-3">arm-v7a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc8</span> <span class="p">-</span> <span class="mi">0x2A0C</span><span class="p">)</span> <span class="c1">; &#34;argc / 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A06</span>                 <span class="no">LSRS</span>            <span class="no">argv</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">MOV</span>             <span class="no">argc</span><span class="p">,</span> <span class="no">R2</span> <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//右移3位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSRS</span>            <span class="no">argv</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#3
</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v8a-1">arm-v8a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">LSR</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B4</span>                 <span class="no">ADRL</span>            <span class="no">X0</span><span class="p">,</span> <span class="no">aArgc8</span> <span class="c1">; &#34;argc / 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//右移3位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSR</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="c1">#3
</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="总结">总结</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">x / 2^n = x &gt;&gt; n
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="除数为非2的幂常量">除数为非2的幂(常量)</h5>
<h6 id="magicnumber无进位">MagicNumber无进位</h6>
<p><strong>源代码</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / 9&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">argc</span> <span class="o">/</span> <span class="mi">9</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v7a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x38E38E39
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">UMULL.W</span>         <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">LDR</span>             <span class="no">R0</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc9</span> <span class="p">-</span> <span class="mi">0x2A16</span><span class="p">)</span> <span class="c1">; &#34;argc / 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">LSRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x38E38E39
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = (argc * R1) &gt;&gt; 32
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">UMULL.W</span>         <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="c1">//R1 = R1 &gt;&gt; 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = (argc * c) &gt;&gt; 32 &gt;&gt; 1
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v8a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x38E38E39
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B8</span>                 <span class="no">UMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">ADRP</span>            <span class="no">argc</span><span class="p">,</span> <span class="c1">#aArgc9@PAGE ; &#34;argc / 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">LSR</span>             <span class="no">argv</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#33 ; &#39;!&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">ADD</span>             <span class="no">X0</span><span class="p">,</span> <span class="no">X0</span><span class="p">,</span> <span class="c1">#aArgc9@PAGEOFF ; &#34;argc / 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">CC</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D0</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//W8 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x38E38E39
</span></span></span><span class="line"><span class="cl"><span class="c1">//X8 = argc * W8 //这里W0就是argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">UMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="c1">//argv = X8 &gt;&gt; 33
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSR</span>             <span class="no">argv</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#33
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>总结</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">上述特征为:x / y = x * c &gt;&gt; 32 &gt;&gt; n
</span></span><span class="line"><span class="cl">还原的话就看c,分为3种情况:
</span></span><span class="line"><span class="cl">c为正数:y = 2^n / c
</span></span><span class="line"><span class="cl">c为负数:y = 2^n / (2^32 - c)
</span></span><span class="line"><span class="cl">c溢出:  y = 2^n / (2^32 + c)
</span></span><span class="line"><span class="cl">以上述arm-v7a为例:
</span></span><span class="line"><span class="cl">c = 0x38E38E39 = 954437177, 为正.
</span></span><span class="line"><span class="cl">n = 32 + 1 = 33
</span></span><span class="line"><span class="cl">则 y = 2^33 / 954437177 = 9
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="magicnumber有进位">MagicNumber有进位</h6>
<p><strong>源代码</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / 7&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">argc</span> <span class="o">/</span> <span class="mi">7</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v7a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">MOVW</span>            <span class="no">argv</span><span class="p">,</span> <span class="c1">#0x4925
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc7</span> <span class="p">-</span> <span class="mi">0x2A16</span><span class="p">)</span> <span class="c1">; &#34;argc / 7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">MOVT</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x2492
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">UMULL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / 7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">SUBS</span>            <span class="no">argc</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">ADD.W</span>           <span class="no">R0</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="no">R0</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">LSRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">R0</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span>                 <span class="no">MOV</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">R2</span>  <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1E</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A22</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A24</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A24</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = 0x24924925 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOVW</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x4925
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOVT</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x2492
</span></span></span><span class="line"><span class="cl"><span class="c1">//R3 = argc * R1 &gt;&gt; 32
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">UMULL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="c1">//argc = argc - R3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SUBS</span>            <span class="no">argc</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R3</span>
</span></span><span class="line"><span class="cl"><span class="c1">//argc = R3 + argc &gt;&gt; 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">argc</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = (argc * c &gt;&gt; 32 + (argc - argc * c &gt;&gt; 32) &gt;&gt; 1) &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">这种形式的还原</span> <span class="nf">y</span> <span class="err">=</span> <span class="mi">2</span><span class="err">^</span><span class="no">n</span> <span class="err">/</span> <span class="p">(</span><span class="mi">2</span><span class="err">^</span><span class="mi">32</span> <span class="err">+</span> <span class="no">c</span><span class="p">)</span> <span class="err">=</span> <span class="mi">2</span><span class="err">^</span><span class="mi">35</span> <span class="err">/</span> <span class="p">(</span><span class="mi">2</span><span class="err">^</span><span class="mi">32</span> <span class="err">+</span> <span class="mi">0x24924925</span><span class="p">)</span> <span class="err">=</span> <span class="mi">7</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v8a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x24924925
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B8</span>                 <span class="no">UMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">LSR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#32 ; &#39; &#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">SUB</span>             <span class="no">W9</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">ADD</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W9</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">ADRP</span>            <span class="no">argc</span><span class="p">,</span> <span class="c1">#aArgc7@PAGE ; &#34;argc / 7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">CC</span>                 <span class="no">LSR</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D0</span>                 <span class="no">ADD</span>             <span class="no">X0</span><span class="p">,</span> <span class="no">X0</span><span class="p">,</span> <span class="c1">#aArgc7@PAGEOFF ; &#34;argc / 7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D8</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//w8 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x24924925
</span></span></span><span class="line"><span class="cl"><span class="c1">//X8 = W0 * W8 = argc * W8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">UMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="c1">//X8 = X8 &gt;&gt; 32
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#32
</span></span></span><span class="line"><span class="cl"><span class="c1">//W9 = W0 - W8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SUB</span>             <span class="no">W9</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="c1">//W8 = W8 + W9 &gt;&gt; 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W9</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1">//W1 = W8 &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSR</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1">//W1 = ((argc * c) &gt;&gt; 32 + (argc - ((argc * c) &gt;&gt; 32) &gt;&gt; 1) &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1">//还原的方法同上
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>总结</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">形如x / y =(x * c &gt;&gt; 32 + (x - x * c &gt;&gt; 32) &gt;&gt; n1) &gt;&gt; n2这种形式的
</span></span><span class="line"><span class="cl">还原的话,y = 2^(32 + n1 + n2)/(2^32 + c)
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="有符号">有符号</h4>
<h5 id="除数为正2的幂">除数为正2的幂</h5>
<h6 id="源代码-4">源代码</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / 8&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">/</span> <span class="mi">8</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v7a-4">arm-v7a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc8</span> <span class="p">-</span> <span class="mi">0x2A10</span><span class="p">)</span> <span class="c1">; &#34;argc / 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A06</span>                 <span class="no">ASRS</span>            <span class="no">argv</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#0x1F
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">ADD.W</span>           <span class="no">argc</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#29
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">ASRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">R0</span><span class="p">,</span> <span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">MOV</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">R2</span>  <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A18</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A18</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = argc &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1">//如果argc为正数, R1 = 0, 否则 R1 = 0xFFFFFFFF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc = argc + R1 &gt;&gt; 29
</span></span></span><span class="line"><span class="cl"><span class="c1">//如果argc为正数, argc = argc, 否则 argc = argc + 7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">argc</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#29
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc &gt;&gt; 3
</span></span></span><span class="line"><span class="cl"><span class="c1">//如果argc为正数, R1 = argc &gt;&gt; 3, 否则 R1 = (argc + 7) &gt;&gt; 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#3
</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v8a-2">arm-v8a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">ADD</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="c1">#7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B4</span>                 <span class="no">CMP</span>             <span class="no">W0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B8</span>                 <span class="no">CSEL</span>            <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">LT</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">ADRP</span>            <span class="no">argc</span><span class="p">,</span> <span class="c1">#aArgc8@PAGE ; &#34;argc / 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">ASR</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">ADD</span>             <span class="no">X0</span><span class="p">,</span> <span class="no">X0</span><span class="p">,</span> <span class="c1">#aArgc8@PAGEOFF ; &#34;argc / 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">CC</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D0</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//W8 = argc + 7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">CMP</span>             <span class="no">argc</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1">//如果argc &lt; 0, W8 = argc + 7, 否则W8 = argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">CSEL</span>            <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">LT</span>
</span></span><span class="line"><span class="cl"><span class="c1">//W1 = W8 &gt;&gt; 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASR</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="c1">#3
</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="总结-1">总结</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nf">x</span> <span class="err">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="no">x</span> <span class="err">/</span> <span class="no">y</span> <span class="err">=</span> <span class="no">x</span> <span class="err">&gt;&gt;</span> <span class="no">n</span>
</span></span><span class="line"><span class="cl"><span class="nf">x</span> <span class="err">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="no">x</span> <span class="err">/</span> <span class="no">y</span> <span class="err">=</span> <span class="p">(</span><span class="no">x</span> <span class="err">+</span> <span class="mi">2</span> <span class="err">^</span><span class="no">n</span> <span class="p">-</span> <span class="mi">1</span><span class="p">)</span> <span class="err">&gt;&gt;</span> <span class="no">n</span>
</span></span><span class="line"><span class="cl"><span class="err">这种还原的话就是,</span><span class="nf">y</span> <span class="err">=</span> <span class="mi">2</span><span class="err">^</span><span class="no">n</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="除数为正非2的幂">除数为正非2的幂</h5>
<h6 id="magicnumber为正">MagicNumber为正</h6>
<p><strong>源代码</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / 9&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">/</span> <span class="mi">9</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v7a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x38E38E39
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">SMMUL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">LDR</span>             <span class="no">argc</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc9</span> <span class="p">-</span> <span class="mi">0x2A16</span><span class="p">)</span> <span class="c1">; &#34;argc / 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">ASRS</span>            <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1E</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A20</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A20</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x38E38E39
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc * R1 &gt;&gt; 32
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMMUL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="c1">//R2 = R1 &gt;&gt; 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASRS</span>            <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = R2 + R1 &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc * c &gt;&gt; 32 &gt;&gt; 1 + argc * c &gt;&gt; 63
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &gt;= 0, argc * c &gt;&gt; 32 &gt;&gt; n
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &lt; 0, argc * c &gt;&gt; 32 &gt;&gt; n + 1
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v8a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x38E38E39
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B8</span>                 <span class="no">SMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">LSR</span>             <span class="no">X9</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#0x3F ; &#39;?&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">ASR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#0x21 ; &#39;!&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">ADRP</span>            <span class="no">argc</span><span class="p">,</span> <span class="c1">#aArgc9@PAGE ; &#34;argc / 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">ADD</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W9</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">CC</span>                 <span class="no">ADD</span>             <span class="no">X0</span><span class="p">,</span> <span class="no">X0</span><span class="p">,</span> <span class="c1">#aArgc9@PAGEOFF ; &#34;argc / 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D0</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D8</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//W8 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x38E38E39
</span></span></span><span class="line"><span class="cl"><span class="c1">//X8 = argc * W8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="c1">//X9 = X8 &gt;&gt; 63
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSR</span>             <span class="no">X9</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#63
</span></span></span><span class="line"><span class="cl"><span class="c1">//X8 = X8 &gt;&gt; 33
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#33
</span></span></span><span class="line"><span class="cl"><span class="c1">//W1 = W8 + W9
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W9</span>
</span></span><span class="line"><span class="cl"><span class="c1">//W1 = argc * c &gt;&gt; 33 + argc * c &gt;&gt; 63
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &gt;= 0, argc * c &gt;&gt; 32 &gt;&gt; n
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &lt; 0,  argc * c &gt;&gt; 32 &gt;&gt; n + 1
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>总结</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nf">c</span><span class="err">为正</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="nf">x</span> <span class="err">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="no">x</span> <span class="p">*</span> <span class="no">c</span> <span class="err">&gt;&gt;</span> <span class="mi">32</span> <span class="err">&gt;&gt;</span> <span class="no">n</span>
</span></span><span class="line"><span class="cl"><span class="nf">x</span> <span class="err">&lt;</span> <span class="mi">0</span><span class="p">,</span>  <span class="no">x</span> <span class="p">*</span> <span class="no">c</span> <span class="err">&gt;&gt;</span> <span class="mi">32</span> <span class="err">&gt;&gt;</span> <span class="no">n</span> <span class="err">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="err">还原的时候,</span> <span class="nf">y</span> <span class="err">=</span> <span class="mi">2</span><span class="err">^</span><span class="p">(</span><span class="mi">32</span> <span class="err">+</span> <span class="no">n</span><span class="p">)</span> <span class="err">/</span> <span class="no">c</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="magicnumber为负">MagicNumber为负</h6>
<p><strong>源代码</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / 7&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">/</span> <span class="mi">7</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v7a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x92492493
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">SMMLA.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">argc</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">LDR</span>             <span class="no">argc</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc7</span> <span class="p">-</span> <span class="mi">0x2A16</span><span class="p">)</span> <span class="c1">; &#34;argc / 7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / 7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">ASRS</span>            <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1E</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A20</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A20</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x92492493
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = R1 * argc &gt;&gt; 32 + argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMMLA.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">argc</span>
</span></span><span class="line"><span class="cl"><span class="c1">//R2 = R1 &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASRS</span>            <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = R2 + R1 &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = (c * argc &gt;&gt; 32 + argc) &gt;&gt; 2 + (c * argc &gt;&gt; 32 + argc) &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &gt;= 0, (c * argc &gt;&gt; 32 + argc) &gt;&gt; 2 + 1
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &lt; 0,  (c * argc &gt;&gt; 32 + argc) &gt;&gt; 2
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v8a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x92492493
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B8</span>                 <span class="no">SMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">LSR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#0x20 ; &#39; &#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">ADD</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">ASR</span>             <span class="no">W9</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">ADRP</span>            <span class="no">argc</span><span class="p">,</span> <span class="c1">#aArgc7@PAGE ; &#34;argc / 7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">CC</span>                 <span class="no">ADD</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W9</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D0</span>                 <span class="no">ADD</span>             <span class="no">X0</span><span class="p">,</span> <span class="no">X0</span><span class="p">,</span> <span class="c1">#aArgc7@PAGEOFF ; &#34;argc / 7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D8</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//W8 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x92492493
</span></span></span><span class="line"><span class="cl"><span class="c1">//X8 = argc * c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="c1">//X8 = X8 &gt;&gt; 32
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#32
</span></span></span><span class="line"><span class="cl"><span class="c1">//W8 = W8 + argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">argc</span>
</span></span><span class="line"><span class="cl"><span class="c1">//W9 = W8 &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASR</span>             <span class="no">W9</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1">//W1 = W9 + W8 &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W9</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//W1 = (argc * c &gt;&gt; 32 + argc) &gt;&gt; 2 + (argc * c &gt;&gt; 32 + argc) &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &gt;= 0, (c * argc &gt;&gt; 32 + argc) &gt;&gt; 2 + 1
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &lt; 0,  (c * argc &gt;&gt; 32 + argc) &gt;&gt; 2
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>总结</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">c为负:
</span></span><span class="line"><span class="cl">x &gt;= 0, (c * x &gt;&gt; 32 + x) &gt;&gt; n + 1
</span></span><span class="line"><span class="cl">x &lt; 0,  (c * x &gt;&gt; 32 + x) &gt;&gt; n
</span></span><span class="line"><span class="cl">还原的时候,y = 2^(32 + n) / c
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="除数为负2的幂">除数为负2的幂</h5>
<h6 id="源代码-5">源代码</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / -8&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">/</span> <span class="o">-</span><span class="mi">8</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v7a-5">arm-v7a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc8</span> <span class="p">-</span> <span class="mi">0x2A12</span><span class="p">)</span> <span class="c1">; &#34;argc / -8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A06</span>                 <span class="no">ASRS</span>            <span class="no">argv</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#0x1F
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">ADD.W</span>           <span class="no">argc</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#29
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">MOVS</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / -8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">SUB.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">R0</span><span class="p">,</span><span class="no">ASR</span><span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">MOV</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">R2</span>  <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = argc &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc = argc + R1 &gt;&gt; 29
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">argc</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#29
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOVS</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1">// R1 = 0 - R0 &gt;&gt; 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SUB.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">R0</span><span class="p">,</span><span class="no">ASR</span><span class="c1">#3
</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v8a-3">arm-v8a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">ADD</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="c1">#7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B4</span>                 <span class="no">CMP</span>             <span class="no">W0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B8</span>                 <span class="no">CSEL</span>            <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">LT</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">ADRP</span>            <span class="no">argc</span><span class="p">,</span> <span class="c1">#aArgc8@PAGE ; &#34;argc / -8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">NEG</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span><span class="no">ASR</span><span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">ADD</span>             <span class="no">X0</span><span class="p">,</span> <span class="no">X0</span><span class="p">,</span> <span class="c1">#aArgc8@PAGEOFF ; &#34;argc / -8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">CC</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D0</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//W8 = argc + 7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">CMP</span>             <span class="no">argc</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1">//如果argc &lt; 0, W8 = argc + 7, 否则W8 = argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">CSEL</span>            <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">LT</span>
</span></span><span class="line"><span class="cl"><span class="c1">//W1 = -W8 &gt;&gt; 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">NEG</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span><span class="no">ASR</span><span class="c1">#3
</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="总结-2">总结</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">除数为负的2的幂的情况,跟除数为正的2的幂的情况相同,只不过加了一个负号
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="除数为负非2的幂">除数为负非2的幂</h5>
<h6 id="magicnumber为正-1">MagicNumber为正</h6>
<p><strong>源代码</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / -7&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">/</span> <span class="o">-</span><span class="mi">7</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v7a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">MOVW</span>            <span class="no">argv</span><span class="p">,</span> <span class="c1">#0xDB6D
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc7</span> <span class="p">-</span> <span class="mi">0x2A16</span><span class="p">)</span> <span class="c1">; &#34;argc / -7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">MOVT</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x6DB6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">SMMUL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / -7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">SUBS</span>            <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">ASRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">R0</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A18</span>                 <span class="no">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">R0</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span>                 <span class="no">MOV</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">R2</span>  <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1E</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A22</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A24</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A24</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = 0x6DB6DB6D = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOVW</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0xDB6D
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOVT</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x6DB6
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc * R1 &gt;&gt; 32
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMMUL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="c1">//argc = R1 - argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SUBS</span>            <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span>
</span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = R1 + argc &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = (argc * c &gt;&gt; 32 - argc) &gt;&gt; 2 + (argc * c &gt;&gt; 32 - argc) &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &gt;= 0, (argc * c &gt;&gt; 32 - argc) &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &lt;  0, (argc * c &gt;&gt; 32 - argc) &gt;&gt; 2 + 1
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v8a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x6DB6DB6D
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B8</span>                 <span class="no">SMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">LSR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#0x20 ; &#39; &#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">SUB</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">ASR</span>             <span class="no">W9</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">ADRP</span>            <span class="no">argc</span><span class="p">,</span> <span class="c1">#aArgc7@PAGE ; &#34;argc / -7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">CC</span>                 <span class="no">ADD</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W9</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D0</span>                 <span class="no">ADD</span>             <span class="no">X0</span><span class="p">,</span> <span class="no">X0</span><span class="p">,</span> <span class="c1">#aArgc7@PAGEOFF ; &#34;argc / -7&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D8</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">E0</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//W8 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0x6DB6DB6D
</span></span></span><span class="line"><span class="cl"><span class="c1">//X8 = argc * W8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="c1">//X8 = X8 &gt;&gt; 32
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#32
</span></span></span><span class="line"><span class="cl"><span class="c1">//W8 = W8 - argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SUB</span>             <span class="no">W8</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">argc</span>
</span></span><span class="line"><span class="cl"><span class="c1">//W9 = W8 &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASR</span>             <span class="no">W9</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="c1">#2
</span></span></span><span class="line"><span class="cl"><span class="c1">//W1 = W9 + W8 &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W9</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//W1 = (argc * c &gt;&gt; 32 - argc) &gt;&gt; 2 + (argc * c &gt;&gt; 32 - argc) &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &gt;= 0, (argc * c &gt;&gt; 32 - argc) &gt;&gt; 2
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &lt;  0, (argc * c &gt;&gt; 32 - argc) &gt;&gt; 2 + 1
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>总结</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">c为正:
</span></span><span class="line"><span class="cl">x &gt;= 0, (x * c &gt;&gt; 32 - x) &gt;&gt; 2
</span></span><span class="line"><span class="cl">x &lt;  0, (x * c &gt;&gt; 32 - x) &gt;&gt; 2 + 1
</span></span><span class="line"><span class="cl">还原的时候, y = -2^(32 + n) / (2^32 - c)
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="magicnumber为负-1">MagicNumber为负</h6>
<p><strong>源代码</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc / -9&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">/</span> <span class="o">-</span><span class="mi">9</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v7a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="c1">#0xC71C71C7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">SMMUL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">LDR</span>             <span class="no">argc</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc9</span> <span class="p">-</span> <span class="mi">0x2A16</span><span class="p">)</span> <span class="c1">; &#34;argc / -9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">ADD</span>             <span class="no">R0</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc / -9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">ASRS</span>            <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31 ; n1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1E</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A20</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A20</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">R1</span><span class="p">,</span> <span class="c1">#0xC71C71C7
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc * R1 &gt;&gt; 32
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMMUL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="c1">//R2 = R1 &gt;&gt; 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASRS</span>            <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = R2 + R1 &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R2</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc * c &gt;&gt; 32 &gt;&gt; 1 + argc * c &gt;&gt; 63
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &gt;= 0, argc * c &gt;&gt; 32 &gt;&gt; n + 1
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &lt; 0, argc * c &gt;&gt; 32 &gt;&gt; n
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>arm-v8a</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: LOAD:0000000000000448↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">var_s0</span>          <span class="err">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">X0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">X1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">A8</span>                 <span class="no">STP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="p">,</span><span class="c1">#-0x10+var_s0]!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">AC</span>                 <span class="no">MOV</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B0</span>                 <span class="no">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0xC71C71C7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">B8</span>                 <span class="no">SMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">W0</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">BC</span>                 <span class="no">LSR</span>             <span class="no">X9</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#63 ; &#39;?&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C0</span>                 <span class="no">ASR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#33 ; &#39;!&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C4</span>                 <span class="no">ADRP</span>            <span class="no">argc</span><span class="p">,</span> <span class="c1">#aArgc9@PAGE ; &#34;argc / -9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">C8</span>                 <span class="no">ADD</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W9</span> <span class="c1">; n1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">CC</span>                 <span class="no">ADD</span>             <span class="no">X0</span><span class="p">,</span> <span class="no">X0</span><span class="p">,</span> <span class="c1">#aArgc9@PAGEOFF ; &#34;argc / -9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D0</span>                 <span class="no">BL</span>              <span class="no">.printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D4</span>                 <span class="no">MOV</span>             <span class="no">W0</span><span class="p">,</span> <span class="no">WZR</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">D8</span>                 <span class="no">LDP</span>             <span class="no">X29</span><span class="p">,</span> <span class="no">X30</span><span class="p">,</span> <span class="p">[</span><span class="no">SP</span><span class="err">+</span><span class="no">var_s0</span><span class="p">],</span><span class="c1">#0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span>                 <span class="no">RET</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span> <span class="c1">; } // starts at 6A8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00000000000006</span><span class="nf">DC</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//W8 = c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOV</span>             <span class="no">W8</span><span class="p">,</span> <span class="c1">#0xC71C71C7
</span></span></span><span class="line"><span class="cl"><span class="c1">//X8 = argc * W8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMULL</span>           <span class="no">X8</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">W8</span>
</span></span><span class="line"><span class="cl"><span class="c1">//X9 = X8 &gt;&gt; 63
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">LSR</span>             <span class="no">X9</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#63
</span></span></span><span class="line"><span class="cl"><span class="c1">//X8 = X8 &gt;&gt; 33
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASR</span>             <span class="no">X8</span><span class="p">,</span> <span class="no">X8</span><span class="p">,</span> <span class="c1">#33
</span></span></span><span class="line"><span class="cl"><span class="c1">//W1 = W8 + W9
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD</span>             <span class="no">W1</span><span class="p">,</span> <span class="no">W8</span><span class="p">,</span> <span class="no">W9</span>
</span></span><span class="line"><span class="cl"><span class="c1">//W1 = argc * c &gt;&gt; 33 + argc * c &gt;&gt; 63
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &gt;= 0, argc * c &gt;&gt; 32 &gt;&gt; n +1
</span></span></span><span class="line"><span class="cl"><span class="c1">//argc &lt; 0,  argc * c &gt;&gt; 32 &gt;&gt; n
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>总结</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">c为负:
</span></span><span class="line"><span class="cl">x &gt;= 0, x * c &gt;&gt; 32 &gt;&gt; n + 1
</span></span><span class="line"><span class="cl">x &lt; 0,  x * c &gt;&gt; 32 &gt;&gt; n
</span></span><span class="line"><span class="cl">还原的时候, y = -2^(32 + n) / (2^32 - c)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="取模">取模</h3>
<h4 id="无符号-1">无符号</h4>
<h5 id="除数为2的幂">除数为2的幂</h5>
<h6 id="源代码-6">源代码</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc % 8&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">argc</span> <span class="o">%</span> <span class="mi">8</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v7a-6">arm-v7a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc8</span> <span class="p">-</span> <span class="mi">0x2A0E</span><span class="p">)</span> <span class="c1">; &#34;argc % 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A06</span>                 <span class="no">AND.W</span>          <span class="no">argv</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc % 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">MOV</span>             <span class="no">argc</span><span class="p">,</span> <span class="no">R2</span> <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = argc &amp; 7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">AND.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#7
</span></span></span></code></pre></td></tr></table>
</div>
</div><h6 id="总结-3">总结</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">x % y = x &amp; (2^ - 1)
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="除数为非2的幂">除数为非2的幂</h5>
<h6 id="源代码-7">源代码</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc % 9&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">argc</span> <span class="o">%</span> <span class="mi">9</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v7a-7">arm-v7a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">EXPORT</span> <span class="no">main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">MOVW</span>            <span class="no">argv</span><span class="p">,</span> <span class="c1">#0x8E39
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc9</span> <span class="p">-</span> <span class="mi">0x2A16</span><span class="p">)</span> <span class="c1">; &#34;argc % 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">MOVT</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x38E3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">UMULL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc % 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">LSRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSL</span><span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">SUBS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span>                 <span class="no">MOV</span>             <span class="no">argc</span><span class="p">,</span> <span class="no">R2</span> <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1E</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A22</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A24</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A24</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nf">MOVW</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x8E39
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOVT</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x38E3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">UMULL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nf">LSRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1">//上面是除法运算,结果在R1中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSL</span><span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SUBS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="c1">//余数 = 被除数 - 除数 * 商
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="有符号-1">有符号</h4>
<h5 id="除数为2的幂-1">除数为2的幂</h5>
<h6 id="源代码-8">源代码</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc % 8&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">%</span> <span class="mi">8</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v7a-8">arm-v7a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc8</span> <span class="p">-</span> <span class="mi">0x2A14</span><span class="p">)</span> <span class="c1">; &#34;argc % 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A06</span>                 <span class="no">ASRS</span>            <span class="no">argv</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#0x1F
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#29
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0C</span>                 <span class="no">BIC.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A10</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc % 8&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">SUBS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">MOV</span>             <span class="no">argc</span><span class="p">,</span> <span class="no">R2</span> <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1C</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">//R1 = argc &gt;&gt; 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ASRS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc + R1 &gt;&gt; 29
</span></span></span><span class="line"><span class="cl"><span class="c1">//如果argc &gt;= 0, R1 = argc
</span></span></span><span class="line"><span class="cl"><span class="c1">//如果argc &lt;  0, R1 = argc + 7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#29
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = R1 &amp; ~7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">BIC.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#7
</span></span></span><span class="line"><span class="cl"><span class="c1">//R1 = argc - R1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SUBS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="总结-4">总结</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">x &gt;= 0,x % y = x - x &amp; ~(2^n - 1)
</span></span><span class="line"><span class="cl">x &lt;  0,x % y = x - (x + 2^n - 1) &amp;~(2^n - 1)
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="除数为非2的幂-1">除数为非2的幂</h5>
<h6 id="源代码-9">源代码</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc % 9&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">%</span> <span class="mi">9</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="arm-v7a-9">arm-v7a</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">main</span>                                    <span class="c1">; DATA XREF: .text:000029BC↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                                         <span class="c1">; .got:main_ptr↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argc</span> <span class="err">=</span> <span class="no">R0</span>                               <span class="c1">; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="no">argv</span> <span class="err">=</span> <span class="no">R1</span>                               <span class="c1">; unsigned __int8 **
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span> <span class="c1">; __unwind {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A00</span>                 <span class="no">PUSH</span>            <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">LR</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A02</span>                 <span class="no">MOV</span>             <span class="no">R7</span><span class="p">,</span> <span class="no">SP</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A04</span>                 <span class="no">MOVW</span>            <span class="no">argv</span><span class="p">,</span> <span class="c1">#0x8E39
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A08</span>                 <span class="no">LDR</span>             <span class="no">R2</span><span class="p">,</span> <span class="err">=</span><span class="p">(</span><span class="no">aArgc9</span> <span class="p">-</span> <span class="mi">0x2A16</span><span class="p">)</span> <span class="c1">; &#34;argc % 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0A</span>                 <span class="no">MOVT</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x38E3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A0E</span>                 <span class="no">SMMUL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A12</span>                 <span class="no">ADD</span>             <span class="no">R2</span><span class="p">,</span> <span class="no">PC</span>  <span class="c1">; &#34;argc % 9&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A14</span>                 <span class="no">ASRS</span>            <span class="no">R3</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A16</span>                 <span class="no">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1A</span>                 <span class="no">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSL</span><span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A1E</span>                 <span class="no">SUBS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A20</span>                 <span class="no">MOV</span>             <span class="no">argc</span><span class="p">,</span> <span class="no">R2</span> <span class="c1">; format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A22</span>                 <span class="no">BLX</span>             <span class="no">printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A26</span>                 <span class="no">MOVS</span>            <span class="no">R0</span><span class="p">,</span> <span class="c1">#0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A28</span>                 <span class="no">POP</span>             <span class="err">{</span><span class="no">R7</span><span class="p">,</span><span class="no">PC</span><span class="err">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00002</span><span class="nf">A28</span> <span class="c1">; End of function main
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nf">MOVW</span>            <span class="no">argv</span><span class="p">,</span> <span class="c1">#0x8E39
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">MOVT</span>            <span class="no">R1</span><span class="p">,</span> <span class="c1">#0x38E3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SMMUL.W</span>         <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="nf">ASRS</span>            <span class="no">R3</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="c1">#1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R3</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSR</span><span class="c1">#31
</span></span></span><span class="line"><span class="cl"><span class="c1">//上面是除法运算, R1为商
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">ADD.W</span>           <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span> <span class="no">R1</span><span class="p">,</span><span class="no">LSL</span><span class="c1">#3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">SUBS</span>            <span class="no">R1</span><span class="p">,</span> <span class="no">argc</span><span class="p">,</span> <span class="no">R1</span>
</span></span><span class="line"><span class="cl"><span class="c1">//余数 = 被除数 - 商 * 除数
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="分支">分支</h3>
<h4 id="if">if</h4>
<h5 id="源代码-10">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">       <span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc &gt; 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="n">puts</span><span class="p">(</span><span class="s">&#34;argc &lt;= 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="arm-v7a-10">arm-v7a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/if.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/if.png, images/Arm%e9%80%86%e5%90%91/if.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/if.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/if.png"
        title="if" /></p>
<h4 id="while">while</h4>
<h5 id="源代码-11">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">       <span class="n">argc</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="arm-v7a-11">arm-v7a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/while.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/while.png, images/Arm%e9%80%86%e5%90%91/while.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/while.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/while.png"
        title="while" /></p>
<h4 id="do-while">do-while</h4>
<h5 id="源代码-12">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">argc</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="arm-v7a-12">arm-v7a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/dowhile.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/dowhile.png, images/Arm%e9%80%86%e5%90%91/dowhile.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/dowhile.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/dowhile.png"
        title="dowhile" /></p>
<h4 id="switch-case">Switch-case</h4>
<p>这里只讨论做表的情况.</p>
<h5 id="源代码-13">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">switch</span> <span class="p">(</span><span class="n">argc</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">5</span><span class="o">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">9</span><span class="o">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;9&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="arm-v7a-13">arm-v7a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/switch.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/switch.png, images/Arm%e9%80%86%e5%90%91/switch.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/switch.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/switch.png"
        title="switch" /></p>
<h3 id="函数">函数</h3>
<p>这一部分跟x86相差还是挺大的.</p>
<h4 id="整型传参">整型传参</h4>
<h5 id="源代码-14">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">add1</span><span class="p">(</span><span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n3</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n4</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n5</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n6</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n7</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n8</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n9</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">+</span> <span class="n">n3</span> <span class="o">+</span> <span class="n">n4</span> <span class="o">+</span> <span class="n">n5</span> <span class="o">+</span> <span class="n">n6</span> <span class="o">+</span> <span class="n">n7</span> <span class="o">+</span> <span class="n">n8</span> <span class="o">+</span> <span class="n">n9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">add1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="arm-v7a-14">arm-v7a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%95%b4%e5%9e%8b%e4%bc%a0%e5%8f%82v7.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B4%E5%9E%8B%E4%BC%A0%E5%8F%82v7.png, images/Arm%e9%80%86%e5%90%91/%e6%95%b4%e5%9e%8b%e4%bc%a0%e5%8f%82v7.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B4%E5%9E%8B%E4%BC%A0%E5%8F%82v7.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B4%E5%9E%8B%E4%BC%A0%E5%8F%82v7.png"
        title="整型传参v7" /></p>
<p>从上面可以看到,前4个整型参数放在寄存器R0-R3中,后面的参数就入栈了,整型返回值放在R0中.</p>
<h5 id="arm-v8a-4">arm-v8a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%95%b4%e5%9e%8b%e4%bc%a0%e5%8f%82v8.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B4%E5%9E%8B%E4%BC%A0%E5%8F%82v8.png, images/Arm%e9%80%86%e5%90%91/%e6%95%b4%e5%9e%8b%e4%bc%a0%e5%8f%82v8.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B4%E5%9E%8B%E4%BC%A0%E5%8F%82v8.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B4%E5%9E%8B%E4%BC%A0%E5%8F%82v8.png"
        title="整型传参v8" /></p>
<p>从上面可以看到,前8个整型参数放在寄存器X0-X7中,后面的参数就入栈了,整型返回值放在X0中.</p>
<h4 id="浮点传参">浮点传参</h4>
<h5 id="源代码-15">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">float</span> <span class="nf">add2</span><span class="p">(</span><span class="kt">float</span> <span class="n">f1</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f2</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f3</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f4</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f5</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f6</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f7</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f8</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f9</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f3</span> <span class="o">+</span> <span class="n">f4</span> <span class="o">+</span> <span class="n">f5</span> <span class="o">+</span> <span class="n">f6</span> <span class="o">+</span> <span class="n">f7</span> <span class="o">+</span> <span class="n">f8</span> <span class="o">+</span> <span class="n">f9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="n">add2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%f</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="arm-v7a-15">arm-v7a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%b5%ae%e7%82%b9%e4%bc%a0%e5%8f%82v7.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B5%AE%E7%82%B9%E4%BC%A0%E5%8F%82v7.png, images/Arm%e9%80%86%e5%90%91/%e6%b5%ae%e7%82%b9%e4%bc%a0%e5%8f%82v7.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B5%AE%E7%82%B9%E4%BC%A0%E5%8F%82v7.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B5%AE%E7%82%B9%E4%BC%A0%E5%8F%82v7.png"
        title="浮点传参v7" /></p>
<p>从上面可以看到,浮点传参跟整型传参没有区别,前4个参数放R0-R3,后面的参数入栈,浮点返回值放在R0中.</p>
<h5 id="arm-v8a-5">arm-v8a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%b5%ae%e7%82%b9%e4%bc%a0%e5%8f%82v8.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B5%AE%E7%82%B9%E4%BC%A0%E5%8F%82v8.png, images/Arm%e9%80%86%e5%90%91/%e6%b5%ae%e7%82%b9%e4%bc%a0%e5%8f%82v8.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B5%AE%E7%82%B9%E4%BC%A0%E5%8F%82v8.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B5%AE%E7%82%B9%E4%BC%A0%E5%8F%82v8.png"
        title="浮点传参v8" /></p>
<p>从上面可以看到,前8个浮点参数,放浮点寄存器S0-S7,后面的浮点参数入栈,浮点返回值放在S0中.</p>
<h4 id="混合传参">混合传参</h4>
<h5 id="源代码-16">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">long</span> <span class="kt">long</span> <span class="nf">add3</span><span class="p">(</span><span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n3</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f4</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n5</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f6</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n7</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f8</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n9</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">n3</span> <span class="o">+</span> <span class="n">f4</span> <span class="o">+</span> <span class="n">n5</span> <span class="o">+</span> <span class="n">f6</span> <span class="o">+</span> <span class="n">n7</span> <span class="o">+</span> <span class="n">f8</span> <span class="o">+</span> <span class="n">n9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">long</span> <span class="kt">long</span> <span class="n">l</span> <span class="o">=</span> <span class="n">add3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="arm-v7a-16">arm-v7a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%b7%b7%e5%90%88%e4%bc%a0%e5%8f%82v7.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B7%B7%E5%90%88%E4%BC%A0%E5%8F%82v7.png, images/Arm%e9%80%86%e5%90%91/%e6%b7%b7%e5%90%88%e4%bc%a0%e5%8f%82v7.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B7%B7%E5%90%88%E4%BC%A0%E5%8F%82v7.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B7%B7%E5%90%88%E4%BC%A0%E5%8F%82v7.png"
        title="混合传参v7" /></p>
<p>从上面可以看到,混合传参对32位没有影响,前4个参数放R0-R3中,后面的参数入栈,长整型的返回值放在R1 .</p>
<h5 id="arm-v8a-6">arm-v8a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%b7%b7%e5%90%88%e4%bc%a0%e5%8f%82v8.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B7%B7%E5%90%88%E4%BC%A0%E5%8F%82v8.png, images/Arm%e9%80%86%e5%90%91/%e6%b7%b7%e5%90%88%e4%bc%a0%e5%8f%82v8.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B7%B7%E5%90%88%E4%BC%A0%E5%8F%82v8.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%B7%B7%E5%90%88%E4%BC%A0%E5%8F%82v8.png"
        title="混合传参v8" /></p>
<p>从上面可以看到,对于混合传参,64位的处理方式还是挺特别的,将整型参数放在X0-X7中,浮点参数放在S0-S7中,单从传参来说,没有办法区分谁是第一个参数,谁是第二个参数,除非有符号.</p>
<h4 id="注意的小细节">注意的小细节</h4>
<h5 id="源代码-17">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">long</span> <span class="kt">long</span> <span class="nf">add4</span><span class="p">(</span><span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">n2</span><span class="p">,</span> <span class="kt">float</span> <span class="n">f3</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">+</span> <span class="n">f3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">long</span> <span class="kt">long</span> <span class="n">l</span> <span class="o">=</span> <span class="n">add4</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="arm-v7a-17">arm-v7a</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e5%87%bd%e6%95%b0%e6%b3%a8%e6%84%8f%e7%9a%84%e5%b0%8f%e7%bb%86%e8%8a%82.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%87%BD%E6%95%B0%E6%B3%A8%E6%84%8F%E7%9A%84%E5%B0%8F%E7%BB%86%E8%8A%82.png, images/Arm%e9%80%86%e5%90%91/%e5%87%bd%e6%95%b0%e6%b3%a8%e6%84%8f%e7%9a%84%e5%b0%8f%e7%bb%86%e8%8a%82.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%87%BD%E6%95%B0%E6%B3%A8%E6%84%8F%E7%9A%84%E5%B0%8F%E7%BB%86%E8%8A%82.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%87%BD%E6%95%B0%E6%B3%A8%E6%84%8F%E7%9A%84%E5%B0%8F%E7%BB%86%E8%8A%82.png"
        title="函数注意的小细节" /></p>
<p>本例中,long long add4(int n1, long long n2, float f3);
按理来说n1放R0,n2放R2, R1, f3放R3.
但从上面的汇编代码来看,并没有用到寄存器R1,
也就是说64位整型,低32位放的应该是2的幂下标的寄存器,如R1 R0, R3 R2.
而不是像R2 R1这种的.</p>
<h3 id="变量">变量</h3>
<h4 id="全局变量">全局变量</h4>
<h5 id="源代码-18">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">g_n1</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">g_n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">g_n3</span> <span class="o">=</span> <span class="n">fun1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">__attribute__</span> <span class="p">((</span><span class="n">constructor</span><span class="p">))</span> <span class="kt">void</span> <span class="n">myload</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;myload</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">g_n2</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__attribute__</span> <span class="p">((</span><span class="n">destructor</span><span class="p">))</span> <span class="kt">void</span> <span class="n">myunload</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;myunload</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d %d %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">g_n1</span><span class="p">,</span> <span class="n">g_n2</span><span class="p">,</span> <span class="n">g_n3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-5">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e5%8f%98%e9%87%8f1.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8F%98%E9%87%8F1.png, images/Arm%e9%80%86%e5%90%91/%e5%8f%98%e9%87%8f1.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8F%98%E9%87%8F1.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8F%98%E9%87%8F1.png"
        title="变量1" /></p>
<p>全局变量初始化以及初始化函数在.init_array这个区段中.
反初始化函数在.fini_array这个区段中.</p>
<h4 id="静态局部变量">静态局部变量</h4>
<h5 id="源代码-19">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">showStatic</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="kt">int</span> <span class="n">nStatic</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">nStatic</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">showStatic</span><span class="p">(</span><span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-6">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e5%8f%98%e9%87%8f2.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8F%98%E9%87%8F2.png, images/Arm%e9%80%86%e5%90%91/%e5%8f%98%e9%87%8f2.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8F%98%E9%87%8F2.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8F%98%E9%87%8F2.png"
        title="变量2" /></p>
<p>这部分跟x86一样,就不细述了.</p>
<h3 id="数组">数组</h3>
<h4 id="一维数组">一维数组</h4>
<h5 id="源代码-20">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">ary</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d %d&#34;</span><span class="p">,</span> <span class="n">ary</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ary</span><span class="p">[</span><span class="n">argc</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-7">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%95%b0%e7%bb%841.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B0%E7%BB%841.png, images/Arm%e9%80%86%e5%90%91/%e6%95%b0%e7%bb%841.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B0%E7%BB%841.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B0%E7%BB%841.png"
        title="数组1" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">假设数组为ary[n]
</span></span><span class="line"><span class="cl">ary[x]寻址:
</span></span><span class="line"><span class="cl">数组首地址 + x * sizeof(type)
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="二维数组">二维数组</h4>
<h5 id="源代码-21">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">ary</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="n">ary</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-8">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%95%b0%e7%bb%842.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B0%E7%BB%842.png, images/Arm%e9%80%86%e5%90%91/%e6%95%b0%e7%bb%842.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B0%E7%BB%842.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%95%B0%E7%BB%842.png"
        title="数组2" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">假设数组为ary[M][N]
</span></span><span class="line"><span class="cl">ary[x][y]寻址:
</span></span><span class="line"><span class="cl">ary + x * sizeof(type[N]) + y * sizeof(type)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="类">类</h3>
<p>如果没有虚函数,类和结构体是没办法区分的.</p>
<h4 id="this指针">this指针</h4>
<h5 id="源代码-22">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nAge</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nHeight</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">~</span><span class="n">Person</span><span class="p">(){};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="nf">GetAge</span><span class="p">(){</span><span class="k">return</span> <span class="n">m_nAge</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="nf">GetHeight</span><span class="p">(){</span><span class="k">return</span> <span class="n">m_nHeight</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nAge</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-9">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/this%e6%8c%87%e9%92%88.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/this%E6%8C%87%E9%92%88.png, images/Arm%e9%80%86%e5%90%91/this%e6%8c%87%e9%92%88.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/this%E6%8C%87%E9%92%88.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/this%E6%8C%87%E9%92%88.png"
        title="this指针" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">32位this指针放在R0,64位this指针放在X0
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="对象作为参数">对象作为参数</h4>
<h5 id="源代码-23">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nAge</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nHeight</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nWeight</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">~</span><span class="n">Person</span><span class="p">(){};</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nAge</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nWeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">showPerson</span><span class="p">(</span><span class="n">Person</span> <span class="n">person</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">person</span><span class="p">.</span><span class="n">m_nAge</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d %d %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">m_nAge</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">m_nHeight</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">m_nWeight</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">showPerson</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-10">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e5%af%b9%e8%b1%a1%e4%bd%9c%e4%b8%ba%e5%8f%82%e6%95%b0.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%AF%B9%E8%B1%A1%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0.png, images/Arm%e9%80%86%e5%90%91/%e5%af%b9%e8%b1%a1%e4%bd%9c%e4%b8%ba%e5%8f%82%e6%95%b0.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%AF%B9%E8%B1%A1%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%AF%B9%E8%B1%A1%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0.png"
        title="对象作为参数" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">将原类中的成员拷贝到一块内存区域,然后将该内存区域的首地址传进去
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="返回对象">返回对象</h4>
<h5 id="源代码-24">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nAge</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nHeight</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nWeight</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">~</span><span class="n">Person</span><span class="p">(){};</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nAge</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nWeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Person</span> <span class="nf">getPerson</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">person</span><span class="p">.</span><span class="n">m_nAge</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">person</span><span class="p">.</span><span class="n">m_nHeight</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">person</span><span class="p">.</span><span class="n">m_nWeight</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>  <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="n">getPerson</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d %d %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">m_nAge</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">m_nHeight</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">m_nWeight</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-11">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e8%bf%94%e5%9b%9e%e5%af%b9%e8%b1%a1.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1.png, images/Arm%e9%80%86%e5%90%91/%e8%bf%94%e5%9b%9e%e5%af%b9%e8%b1%a1.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1.png"
        title="返回对象" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">多传一个存放类对象的地址进去
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="构造函数">构造函数</h4>
<h5 id="源代码-25">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Person()&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">~</span><span class="n">Person</span><span class="p">(){};</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getAge</span><span class="p">(){</span><span class="k">return</span> <span class="n">m_nAge</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getHeight</span><span class="p">(){</span><span class="k">return</span> <span class="n">m_nHeight</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nAge</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-12">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0.png, images/Arm%e9%80%86%e5%90%91/%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0.png"
        title="构造函数" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">类有虚函数,才可以识别构造函数
</span></span><span class="line"><span class="cl">在构造函数中很明显的特征就是要填虚表地址,
</span></span><span class="line"><span class="cl">还有一些特征比如说作用域内第一次调用,返回this指针
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="虚析构">虚析构</h4>
<h5 id="源代码-26">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Person()&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="o">~</span><span class="n">Person</span><span class="p">(){};</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getAge</span><span class="p">(){</span><span class="k">return</span> <span class="n">m_nAge</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getHeight</span><span class="p">(){</span><span class="k">return</span> <span class="n">m_nHeight</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nAge</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">-&gt;~</span><span class="n">Person</span><span class="p">();</span><span class="c1">//这种没有释放空间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">delete</span> <span class="n">p</span><span class="p">;</span>  <span class="c1">//这种要释放空间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-13">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e8%99%9a%e6%9e%90%e6%9e%841.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%99%9A%E6%9E%90%E6%9E%841.png, images/Arm%e9%80%86%e5%90%91/%e8%99%9a%e6%9e%90%e6%9e%841.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%99%9A%E6%9E%90%E6%9E%841.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%99%9A%E6%9E%90%E6%9E%841.png"
        title="虚析构1" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e8%99%9a%e6%9e%90%e6%9e%842.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%99%9A%E6%9E%90%E6%9E%842.png, images/Arm%e9%80%86%e5%90%91/%e8%99%9a%e6%9e%90%e6%9e%842.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%99%9A%E6%9E%90%E6%9E%842.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E8%99%9A%E6%9E%90%E6%9E%842.png"
        title="虚析构2" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">VS编译的x86需要传参来判断是不是需要释放空间,
</span></span><span class="line"><span class="cl">而Clang编译的Arm却不是这样的,它生成了两个析构函数,一个释放空间,一个没有释放空间.
</span></span><span class="line"><span class="cl">这样的话,析构就不需要传参了.
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="单重继承">单重继承</h4>
<h5 id="源代码-27">源代码</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BaseHuman</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">BaseHuman</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_nBase</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nBase</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="o">:</span> <span class="k">public</span> <span class="n">BaseHuman</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Person()&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="o">~</span><span class="n">Person</span><span class="p">()</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getAge</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_nAge</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getHeight</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_nHeight</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nAge</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">m_nHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="总结-14">总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="images/Arm%e9%80%86%e5%90%91/%e5%8d%95%e9%87%8d%e7%bb%a7%e6%89%bf.png"
        data-srcset="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8D%95%E9%87%8D%E7%BB%A7%E6%89%BF.png, images/Arm%e9%80%86%e5%90%91/%e5%8d%95%e9%87%8d%e7%bb%a7%e6%89%bf.png 1.5x, /posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8D%95%E9%87%8D%E7%BB%A7%E6%89%BF.png 2x"
        data-sizes="auto"
        alt="/posts/android/android%E5%9F%BA%E7%A1%80/arm%E9%80%86%E5%90%91/images/Arm%E9%80%86%E5%90%91/%E5%8D%95%E9%87%8D%E7%BB%A7%E6%89%BF.png"
        title="单重继承" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">父类构造在填虚表之前,
</span></span><span class="line"><span class="cl">成员对象构造在填虚表之后.
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-09-12</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/arm/">Arm</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/cobaltstrike/" class="prev" rel="prev" title="CobaltStrike使用"><i class="fas fa-angle-left fa-fw"></i>CobaltStrike使用</a>
            <a href="/posts/android/android%E5%9F%BA%E7%A1%80/dex/" class="next" rel="next" title="Dex">Dex<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">夏洛魂</div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">夏洛魂</a></span>&nbsp;|&nbsp;<span class="license">MIT</span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":150},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
